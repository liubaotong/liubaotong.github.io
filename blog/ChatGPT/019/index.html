<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width">
		<link rel="icon" type="image/svg+xml" href="/favicon.svg">
		<meta name="generator" content="Astro v2.2.1">
		<title></title>
	<link rel="stylesheet" href="/_astro/001.c8750cb8.css" /></head>
	<body>
		<h1 id="windows注册表详解">windows注册表详解</h1>
<h2 id="user">user:</h2>
<p>windows注册表详解</p>
<h2 id="assistant">assistant:</h2>
<p>Windows注册表是Windows操作系统中的一个重要组成部分，它用于存储计算机配置和用户设置。注册表是一个数据库，包含了所有安装在计算机上的软件、硬件以及系统组件的信息。在Windows中，通过使用注册表编辑器程序（regedit.exe）可以查看和编辑注册表。</p>
<p>Windows注册表分为五个主要分支，包括HKEY_CLASSES_ROOT、HKEY_CURRENT_USER、HKEY_LOCAL_MACHINE、HKEY_USERS和HKEY_CURRENT_CONFIG。下面分别介绍这些分支的作用。</p>
<ol>
<li>
<p>HKEY_CLASSES_ROOT（基本键类）
HKEY_CLASSES_ROOT存储了文件类型和对象标识符（GUID）的注册信息。它作为所有用户和计算机共享的全局数据库，包含了所有在计算机上注册的COM组件和文件类型等信息。当应用程序需要查找文件类型关联或者COM组件时，就可以通过查询HKEY_CLASSES_ROOT来获取信息。</p>
</li>
<li>
<p>HKEY_CURRENT_USER（当前用户键）
HKEY_CURRENT_USER包含了当前用户的配置信息，包括桌面、外观、软件设置等。它只包括当前用户的信息，不包含其他用户的信息。当用户登录系统时，Windows会自动加载相应的配置信息，并将其存储在HKEY_CURRENT_USER中。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE（本地机器键）
HKEY_LOCAL_MACHINE存储了计算机的硬件配置信息，以及所有软件和系统设置。这个分支是所有用户共享的，存储了计算机的全局性配置信息。这些配置信息包括安装的硬件设备、驱动程序、设备的标识符、系统路径和文件名等信息。</p>
</li>
<li>
<p>HKEY_USERS（用户键）
HKEY_USERS存储了所有用户的配置信息，包括HKEY_CURRENT_USER中的信息和其他用户的配置信息。当新用户登录系统时，Windows会自动创建一个新的HKEY_USERS分支，存储该用户的配置信息。</p>
</li>
<li>
<p>HKEY_CURRENT_CONFIG（当前配置键）
HKEY_CURRENT_CONFIG包含了计算机的当前硬件配置信息。当系统启动时，Windows会自动加载HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Hardware Profiles\Current分支中的配置信息，并将其存储在HKEY_CURRENT_CONFIG中。</p>
</li>
</ol>
<p>总之，Windows注册表是一个非常重要的数据库，它存储了计算机的所有配置信息，包括软件设置、硬件配置、用户配置等。了解Windows注册表的结构和使用方法，可以帮助我们更好地管理计算机，并解决问题。但是，如果不小心编辑了错误的键值，可能会导致系统不稳定或者无法启动，因此在操作注册表时要非常小心谨慎。</p>
<h2 id="user-1">user:</h2>
<p>常用的注册表项</p>
<h2 id="assistant-1">assistant:</h2>
<p>在Windows注册表中，有许多常用的注册表项和键值，下面列举一些常见的注册表项及其作用。</p>
<ol>
<li>
<p>HKEY_CLASSES_ROOT\exefile
这个项存储了Windows可执行文件的信息，包括默认图标、文件关联的执行方式等。</p>
</li>
<li>
<p>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
这个项存储了Windows资源管理器的高级设置，包括隐藏文件、显示扩展名等。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
这个项存储了Windows启动时自动运行的程序列表，可以通过编辑这个项来控制开机时启动的程序。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
这个项存储了Windows登录信息，包括用户登录信息、默认用户配置等。</p>
</li>
<li>
<p>HKEY_CURRENT_USER\Control Panel\Desktop
这个项存储了Windows桌面的相关设置，包括壁纸、屏幕保护程序等。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services
这个项存储了Windows系统服务的配置信息，包括启动类型、服务名称等。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management
这个项存储了Windows内存管理器的配置信息，包括虚拟内存大小、内存泄漏检测等。</p>
</li>
<li>
<p>HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main
这个项存储了Internet Explorer浏览器的相关配置信息，包括首页、工具栏等。</p>
</li>
</ol>
<p>在使用Windows时，如果遇到一些需要自定义或调整的功能或设置，可以通过编辑或增加注册表项来实现。但是，由于注册表项的修改可能会对系统造成不良影响，因此在修改前需要备份注册表或者谨慎操作，以免引发系统故障或数据丢失。</p>
<ol start="9">
<li>
<p>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies
这个项存储了Windows策略的相关信息，包括用户权限、安全策略等。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts
这个项存储了Windows字体的配置信息，包括系统预装字体以及用户安装的字体等。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkCards
这个项存储了Windows网络接口卡的相关信息，包括网卡名称、IP地址等。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MediaPlayer\Preferences
这个项存储了Windows Media Player（媒体播放器）的配置信息，包括播放列表、扩展名关联等。</p>
</li>
<li>
<p>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings
这个项存储了Windows网络设置的相关信息，包括代理设置、安全设置等。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall
这个项存储了Windows系统中安装的程序信息，可以删除程序时使用。</p>
</li>
<li>
<p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers
这个项存储了Windows打印机的相关信息，包括打印机设置、状态等。</p>
</li>
</ol>
<p>以上是一些常见的Windows注册表项，还有许多其他的注册表项和键值，具体使用和编辑方法需要根据实际情况进行。需要注意的是，对于不熟悉注册表的用户，建议不要轻易修改注册表项，以免对系统造成不良影响。</p>
<h2 id="user-2">user:</h2>
<p>开机启动项</p>
<h2 id="assistant-2">assistant:</h2>
<p>在Windows系统中，许多程序、服务和驱动都会在系统启动时自动启动，并随之加载到内存中。这些开机启动项会降低系统启动速度，占用系统资源，甚至会导致系统不稳定或出现故障。因此，用户可以优化开机启动项，以提高系统启动速度和性能。</p>
<p>下面介绍几种常见的开机启动项：</p>
<ol>
<li>
<p>在启动文件夹中的程序
许多程序会在启动时自动将自己添加到启动文件夹中，包括C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup和C:\Users{用户名}\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup等。用户可以打开相应的文件夹，检查并删除其中不需要的程序。注意，这个方法只能禁止启动文件夹中的程序，无法禁用其他的开机启动项。</p>
</li>
<li>
<p>系统配置实用程序（msconfig）
用户可以使用系统配置实用程序（msconfig）来管理开机启动项。打开“运行”窗口（Win+R），输入msconfig并按回车键，打开系统配置窗口。在“启动”选项卡中，勾选或取消需要启动或禁止的开机启动项，应用更改后重启系统即可生效。</p>
</li>
<li>
<p>任务管理器
Windows 10中的任务管理器可以管理开机启动项。按Ctrl+Shift+Esc打开任务管理器，切换到“启动”选项卡，选择需要禁用的开机启动项，右键选择禁用即可。</p>
</li>
<li>
<p>注册表
用户还可以通过编辑注册表来禁用开机启动项。打开“运行”窗口，输入regedit并按回车键，打开注册表编辑器。找到HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run和HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run项，删除不需要启动的程序即可。注意，对于不熟悉注册表的用户，谨慎操作，以免删除错误键值导致系统故障。</p>
</li>
</ol>
<h2 id="user-3">user:</h2>
<p>jscript操作注册表</p>
<h2 id="assistant-3">assistant:</h2>
<p>在jscript中，可以使用Windows Script Host提供的WshShell对象来操作注册表。下面是操作注册表的基本代码：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> WshShell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WScript.Shell"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 读取注册表值</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> val </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> WshShell.</span><span style="color: #D2A8FF">RegRead</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"HKEY_CURRENT_USER</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Software</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Microsoft</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Windows</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">CurrentVersion</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Explorer</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">User Shell Folders</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Personal"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 写入注册表值</span></span>
<span class="line"><span style="color: #C9D1D9">WshShell.</span><span style="color: #D2A8FF">RegWrite</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"HKEY_CURRENT_USER</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Software</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyApp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Setting</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Value"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"Hello, world!"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"REG_SZ"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 删除注册表值</span></span>
<span class="line"><span style="color: #C9D1D9">WshShell.</span><span style="color: #D2A8FF">RegDelete</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"HKEY_CURRENT_USER</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Software</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyApp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Setting</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Value"</span><span style="color: #C9D1D9">);</span></span></code></pre>
<p>上述代码中，WshShell.RegRead()方法用于读取注册表值，WshShell.RegWrite()方法用于写入注册表值，WshShell.RegDelete()方法用于删除注册表值。其中，第一个参数是注册表路径和键名，第二个参数是键值（写入时使用），第三个参数是键类型（字符串类型的”REG_SZ”、整数类型的”REG_DWORD”等）。</p>
<p>注意，JScript使用的是Windows Script Host环境，必须在Windows系统中才能运行。并且，对于非管理员用户来说，有些系统关键注册表项是只读或禁止修改的，需要以管理员身份运行脚本才能进行修改。</p>
<h2 id="user-4">user:</h2>
<p>jscript操作文件系统</p>
<h2 id="assistant-4">assistant:</h2>
<p>在jscript中，通过使用Windows Script Host提供的FileSystemObject对象可以操作文件系统。下面是操作文件系统的基本代码：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> fso </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Scripting.FileSystemObject"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 创建文件夹</span></span>
<span class="line"><span style="color: #C9D1D9">fso.</span><span style="color: #D2A8FF">CreateFolder</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Temp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFolder"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 复制文件</span></span>
<span class="line"><span style="color: #C9D1D9">fso.</span><span style="color: #D2A8FF">CopyFile</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Temp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFile.txt"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"D:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Backup</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFile.txt"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 移动文件</span></span>
<span class="line"><span style="color: #C9D1D9">fso.</span><span style="color: #D2A8FF">MoveFile</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Temp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFile.txt"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Documents</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFile.txt"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 删除文件</span></span>
<span class="line"><span style="color: #C9D1D9">fso.</span><span style="color: #D2A8FF">DeleteFile</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Temp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFile.txt"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 判断文件或文件夹是否存在</span></span>
<span class="line"><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fso.</span><span style="color: #D2A8FF">FileExists</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Temp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFile.txt"</span><span style="color: #C9D1D9">)) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// 文件存在</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fso.</span><span style="color: #D2A8FF">FolderExists</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Temp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFolder"</span><span style="color: #C9D1D9">)) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// 文件夹存在</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 获取文件信息</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> file </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fso.</span><span style="color: #D2A8FF">GetFile</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Temp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFile.txt"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(file.Name); </span><span style="color: #8B949E">// 文件名</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(file.Path); </span><span style="color: #8B949E">// 文件路径</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(file.Size); </span><span style="color: #8B949E">// 文件大小</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(file.DateCreated); </span><span style="color: #8B949E">// 创建时间</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(file.DateLastModified); </span><span style="color: #8B949E">// 修改时间</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// 获取文件夹信息</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> folder </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fso.</span><span style="color: #D2A8FF">GetFolder</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Temp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyFolder"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(folder.Name); </span><span style="color: #8B949E">// 文件夹名</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(folder.Path); </span><span style="color: #8B949E">// 文件夹路径</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(folder.SubFolders.Count); </span><span style="color: #8B949E">// 子文件夹个数</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(folder.Files.Count); </span><span style="color: #8B949E">// 文件个数</span></span></code></pre>
<p>上述代码中，首先创建了一个FileSystemObject对象，然后通过该对象的方法来操作文件系统。例如，使用CreateFolder方法创建文件夹，使用CopyFile和MoveFile方法复制和移动文件，使用DeleteFile方法删除文件，使用FileExists和FolderExists方法判断文件和文件夹是否存在，使用GetFile和GetFolder方法获取文件和文件夹的信息。其中，GetFile和GetFolder方法返回的是File和Folder对象，可以调用它们的属性来获取文件和文件夹的详细信息。</p>
<h2 id="user-5">user:</h2>
<p>jscript操作网络</p>
<h2 id="assistant-5">assistant:</h2>
<p>在jscript中，可以使用Windows Script Host提供的XMLHttpRequest对象来操作网络。XMLHttpRequest对象是JavaScript中常用的对象，可以通过HTTP协议进行网络通信。</p>
<p>下面是使用XMLHttpRequest对象发送GET请求的基本代码：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> xmlhttp </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Microsoft.XMLHTTP"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">xmlhttp.</span><span style="color: #D2A8FF">open</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"GET"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"http://example.com/api/data"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">xmlhttp.</span><span style="color: #D2A8FF">send</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (xmlhttp.readyState </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> xmlhttp.status </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">200</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(xmlhttp.responseText);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>上述代码中，首先创建了一个XMLHttpRequest对象，然后使用open方法指定请求方法和请求地址。其中，第三个参数表示请求是否异步处理。接着使用send方法发送请求。当请求完成后，可以通过readyState和status属性获取请求的状态和状态码。通常情况下，状态码为200表示请求成功。最后，可以通过responseText属性获取服务器返回的数据。</p>
<p>如果需要发送POST请求，可以使用setRequestHeader方法设置请求头，使用send方法传递请求数据。下面是发送POST请求的基本代码：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> xmlhttp </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Microsoft.XMLHTTP"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">xmlhttp.</span><span style="color: #D2A8FF">open</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"POST"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"http://example.com/api/login"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">xmlhttp.</span><span style="color: #D2A8FF">setRequestHeader</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Content-Type"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"application/x-www-form-urlencoded"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">xmlhttp.</span><span style="color: #D2A8FF">send</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"username=admin&#x26;password=123456"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (xmlhttp.readyState </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> xmlhttp.status </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">200</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(xmlhttp.responseText);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>上述代码中，使用了setRequestHeader方法设置了Content-Type请求头为表单类型。然后使用send方法传递了用户名和密码数据。需要根据具体情况来设置请求头和请求数据。</p>
<p>除了XMLHttpRequest对象，还可以使用WinHttp.WinHttpRequest对象来进行HTTP通信，它提供了更多的功能和选项。可以参考相关资料学习使用。</p>
<h2 id="user-6">user:</h2>
<p>windows提供的所有ActiveXObject可操作对象</p>
<h2 id="assistant-6">assistant:</h2>
<p>Windows提供了许多ActiveXObject，可以用于操作各种系统资源和应用程序。下面是一些常用的ActiveXObject：</p>
<ol>
<li>ADODB.Stream：用于读写二进制数据流。</li>
<li>Scripting.FileSystemObject：用于操作文件系统。</li>
<li>WScript.Shell：用于执行系统命令和操作注册表等任务。</li>
<li>MSXML2.XMLHTTP：用于发送HTTP请求和解析XML等任务。</li>
<li>Excel.Application：用于操作Excel应用程序。</li>
<li>Word.Application：用于操作Word应用程序。</li>
<li>InternetExplorer.Application：用于操作Internet Explorer浏览器。</li>
<li>WIA.CommonDialog：用于操作数字相机或扫描仪等WIA兼容设备。</li>
<li>Shell.Application：用于操作Windows Shell，包括访问系统文件夹和操作快捷方式等。</li>
<li>Speech.Synthesis：用于进行语音合成。</li>
<li>Microsoft.XMLDOM：用于创建和操作XML文档。</li>
<li>System.Text.ASCIIEncoding：用于进行ASCII编码和解码。</li>
<li>System.IO.File：用于操作文件和文件夹。</li>
</ol>
<p>以上是一些常用的ActiveXObject，还有其他许多可用的对象。需要注意的是，使用ActiveXObject需要谨慎，只有在必要的情况下才应该使用。另外，在进行系统级操作时，还需要注意安全和权限等问题，避免造成不必要的损失和风险。</p>
<h2 id="user-7">user:</h2>
<p>每个对象都给个实例</p>
<h2 id="assistant-7">assistant:</h2>
<ol>
<li>ADODB.Stream</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> stream </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"ADODB.Stream"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">stream.</span><span style="color: #D2A8FF">Open</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">stream.Type </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">stream.</span><span style="color: #D2A8FF">Write</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Hello World"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">stream.Position </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">stream.Type </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> content </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> stream.</span><span style="color: #D2A8FF">ReadText</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">-</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">stream.</span><span style="color: #D2A8FF">Close</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(content);</span></span></code></pre>
<p>上述代码创建了一个ADODB.Stream对象，使用Open方法打开数据流。然后设置Type属性为1表示二进制类型，并使用Write方法写入数据。接着使用Position属性将读取位置设置到开头，然后设置Type为2表示文本类型，并使用ReadText方法读取数据。最后使用Close方法关闭数据流，并将读取到的数据打印到控制台。</p>
<ol start="2">
<li>Scripting.FileSystemObject</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> fso </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Scripting.FileSystemObject"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> file </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fso.</span><span style="color: #D2A8FF">CreateTextFile</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"test.txt"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">file.</span><span style="color: #D2A8FF">WriteLine</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Hello World"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">file.</span><span style="color: #D2A8FF">Close</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> readfile </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fso.</span><span style="color: #D2A8FF">OpenTextFile</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"test.txt"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> content </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> readfile.</span><span style="color: #D2A8FF">ReadAll</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">readfile.</span><span style="color: #D2A8FF">Close</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(content);</span></span></code></pre>
<p>上述代码创建了一个Scripting.FileSystemObject对象，使用CreateTextFile方法创建一个文本文件，并使用WriteLine方法写入数据。接着使用OpenTextFile方法打开文件，并使用ReadAll方法读取所有数据，最后关闭文件，并将读取到的数据打印到控制台。</p>
<ol start="3">
<li>WScript.Shell</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> shell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WScript.Shell"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"notepad.exe"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">SendKeys</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Hello World"</span><span style="color: #C9D1D9">);</span></span></code></pre>
<p>上述代码创建了一个WScript.Shell对象，使用Run方法运行notepad应用程序。然后使用SendKeys方法输入字符串到notepad窗口。</p>
<ol start="4">
<li>MSXML2.XMLHTTP</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> xmlhttp </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"MSXML2.XMLHTTP"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">xmlhttp.</span><span style="color: #D2A8FF">open</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"GET"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"http://example.com/api/data"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">xmlhttp.</span><span style="color: #D2A8FF">send</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (xmlhttp.readyState </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> xmlhttp.status </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">200</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(xmlhttp.responseText);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>上述代码创建了一个MSXML2.XMLHTTP对象，使用open方法打开HTTP连接，并使用send方法发送请求。当请求完成后，使用responseText属性获取服务器返回的数据，并将数据打印到控制台。</p>
<ol start="5">
<li>Excel.Application</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> excel </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Excel.Application"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">excel.Visible </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> workbook </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> excel.Workbooks.</span><span style="color: #D2A8FF">Add</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> sheet </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> workbook.</span><span style="color: #D2A8FF">Sheets</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">sheet.</span><span style="color: #D2A8FF">Range</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"A1"</span><span style="color: #C9D1D9">).Value </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"Hello"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">sheet.</span><span style="color: #D2A8FF">Range</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"B1"</span><span style="color: #C9D1D9">).Value </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"World"</span><span style="color: #C9D1D9">;</span></span></code></pre>
<p>上述代码创建了一个Excel.Application对象，使用Visible属性设置可见性为true。然后使用Workbooks.Add方法创建一个新的工作簿，并使用Sheets方法获取第一个工作表。接着使用Range属性设置单元格内容为”Hello”和”World”。</p>
<ol start="6">
<li>Word.Application</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> word </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Word.Application"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">word.Visible </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> document </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> word.Documents.</span><span style="color: #D2A8FF">Add</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> header </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> document.</span><span style="color: #D2A8FF">Sections</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">).</span><span style="color: #D2A8FF">Headers</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">header.Range.Text </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"Header"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> para1 </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> document.Content.Paragraphs.</span><span style="color: #D2A8FF">Add</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">para1.Range.Text </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"Hello"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> para2 </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> document.Content.Paragraphs.</span><span style="color: #D2A8FF">Add</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">para2.Range.Text </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"World"</span><span style="color: #C9D1D9">;</span></span></code></pre>
<p>上述代码创建了一个Word.Application对象，使用Visible属性设置可见性为true。然后使用Documents.Add方法创建一个新的文档，并使用Sections方法获取第一个节。接着使用Headers属性获取第一个页眉，并使用Range属性设置页眉内容为”Header”。最后使用Content属性获取文档内容，并使用Paragraphs方法和Range属性添加和设置文本段落。</p>
<ol start="7">
<li>InternetExplorer.Application</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ie </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"InternetExplorer.Application"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">ie.Visible </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">ie.</span><span style="color: #D2A8FF">Navigate</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"http://example.com"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (ie.Busy) {</span></span>
<span class="line"><span style="color: #C9D1D9">    WScript.</span><span style="color: #D2A8FF">Sleep</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">100</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> content </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ie.Document.body.innerHTML;</span></span>
<span class="line"><span style="color: #C9D1D9">ie.</span><span style="color: #D2A8FF">Quit</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(content);</span></span></code></pre>
<p>上述代码创建了一个InternetExplorer.Application对象，使用Visible属性设置可见性为true，并使用Navigate方法导航到指定网址。使用while循环等待IE完成页面加载完成。然后使用Document属性获取页面文档，并使用body属性获取页面内容，并将内容打印到控制台。接着使用Quit方法关闭IE。</p>
<ol start="8">
<li>WIA.CommonDialog</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> dialog </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WIA.CommonDialog"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> item </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> dialog.</span><span style="color: #D2A8FF">ShowAcquireImage</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> image </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> item.</span><span style="color: #79C0FF">WIA</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">ItemData</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">).</span><span style="color: #D2A8FF">Transfer</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> filename </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"image.jpg"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> data </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> image.</span><span style="color: #D2A8FF">SaveToMemory</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> stream </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"ADODB.Stream"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">stream.Type </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">stream.</span><span style="color: #D2A8FF">Open</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">stream.</span><span style="color: #D2A8FF">Write</span><span style="color: #C9D1D9">(data);</span></span>
<span class="line"><span style="color: #C9D1D9">stream.</span><span style="color: #D2A8FF">SaveToFile</span><span style="color: #C9D1D9">(filename, </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">stream.</span><span style="color: #D2A8FF">Close</span><span style="color: #C9D1D9">();</span></span></code></pre>
<p>上述代码创建了一个WIA.CommonDialog对象，使用ShowAcquireImage方法显示图像采集对话框。使用ItemData属性获取采集到的图像，使用Transfer方法获取图像数据。接着将图像保存为文件，并将文件内容保存到内存流中，最后使用ADODB.Stream对象将数据保存为文件。</p>
<ol start="9">
<li>Shell.Application</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> shell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Shell.Application"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> folder </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> shell.</span><span style="color: #D2A8FF">NameSpace</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Windows"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> items </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> folder.</span><span style="color: #D2A8FF">Items</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> items.Count; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> item </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> items.</span><span style="color: #D2A8FF">Item</span><span style="color: #C9D1D9">(i);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> filename </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> item.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(filename);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>上述代码创建了一个Shell.Application对象，使用NameSpace方法打开C:\Windows文件夹。使用Items方法获取文件夹内的所有项，并遍历所有项。使用Name属性获取项的名称，并将名称打印到控制台。</p>
<ol start="10">
<li>Speech.Synthesis</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> speech </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Speech.Synthesis"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">speech.</span><span style="color: #D2A8FF">Speak</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Hello World"</span><span style="color: #C9D1D9">);</span></span></code></pre>
<p>上述代码创建了一个Speech.Synthesis对象，使用Speak方法进行语音合成，输出”Hello World”。</p>
<ol start="11">
<li>Microsoft.XMLDOM</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> xml </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Microsoft.XMLDOM"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">xml.</span><span style="color: #D2A8FF">loadXML</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"&#x3C;root>&#x3C;item>Hello&#x3C;/item>&#x3C;item>World&#x3C;/item>&#x3C;/root>"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> items </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> xml.documentElement.childNodes;</span></span>
<span class="line"><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> items.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> item </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> items[i];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (item.nodeType </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(item.nodeName </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">": "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> item.text);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>上述代码创建了一个Microsoft.XMLDOM对象，使用loadXML方法加载XML内容。使用documentElement属性获取根节点，并使用childNodes属性获取所有子节点。遍历所有子节点，使用nodeType属性判断节点类型是否为元素节点，然后使用nodeName和text属性获取节点名称和内容，并将它们打印到控制台。</p>
<ol start="12">
<li>System.Text.ASCIIEncoding</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> encoding </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"System.Text.ASCIIEncoding"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> text </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"Hello World"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> bytes </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> encoding.</span><span style="color: #D2A8FF">GetBytes_4</span><span style="color: #C9D1D9">(text);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> hex </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> bytes.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> byte </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> bytes[i].</span><span style="color: #D2A8FF">toString</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">16</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (byte.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        byte </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"0"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> byte;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    hex </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> byte;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(hex);</span></span></code></pre>
<p>上述代码创建了一个System.Text.ASCIIEncoding对象，使用GetBytes_4方法将字符串编码为ASCII字节序列。然后遍历所有字节，使用toString(16)方法将字节转换为十六进制字符串，并使用if语句进行长度处理，最后将所有字节的十六进制字符串拼接成一个字符串，并将它打印到控制台。</p>
<ol start="13">
<li>System.IO.File</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> filename </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"test.txt"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> contents </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"Hello World"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">System.</span><span style="color: #79C0FF">IO</span><span style="color: #C9D1D9">.File.</span><span style="color: #D2A8FF">WriteAllText</span><span style="color: #C9D1D9">(filename, contents);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> readContents </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> System.</span><span style="color: #79C0FF">IO</span><span style="color: #C9D1D9">.File.</span><span style="color: #D2A8FF">ReadAllText</span><span style="color: #C9D1D9">(filename);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(readContents);</span></span></code></pre>
<p>上述代码使用System.IO.File对象进行文件的读写操作。使用WriteAllText方法将内容写入文件中。使用ReadAllText方法读取文件内容，并将它打印到控制台。需要注意，这里使用了.NET Framework提供的对象和方法，需要保证系统中已经安装和配置好.NET Framework。</p>
<h2 id="user-8">user:</h2>
<p>Jscript和Javascript的语法差别</p>
<h2 id="assistant-8">assistant:</h2>
<p>JScript和JavaScript是两个不同的语言，分别是微软公司和Netscape公司开发的。尽管两者都遵守了ECMAScript规范，但是在语法上还是有一些不同之处。</p>
<p>以下是JScript和JavaScript语法差别的几个方面：</p>
<ol>
<li>变量声明</li>
</ol>
<p>在JavaScript中，可以省略var关键字来声明变量，例如：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">x </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">;</span></span></code></pre>
<p>但是在JScript中，必须使用var关键字来声明变量，例如：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">;</span></span></code></pre>
<ol start="2">
<li>数据类型</li>
</ol>
<p>在JavaScript中，有六种数据类型：字符串、数字、布尔、对象、null和undefined。</p>
<p>在JScript中，也有六种数据类型：字符串、数字、布尔、对象、null和未定义（即未初始化的变量）。</p>
<p>但是在JScript中，null和undefined是等价的。也就是说，在JScript中，可以使用null或undefined来表示一个变量没有被初始化。</p>
<ol start="3">
<li>对象属性</li>
</ol>
<p>在JavaScript中，可以使用点号或方括号来访问对象属性，例如：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> person </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {name: </span><span style="color: #A5D6FF">"John"</span><span style="color: #C9D1D9">, age: </span><span style="color: #79C0FF">30</span><span style="color: #C9D1D9">};</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name1 </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> person.name;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name2 </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> person[</span><span style="color: #A5D6FF">"name"</span><span style="color: #C9D1D9">];</span></span></code></pre>
<p>在JScript中，只能使用方括号来访问对象属性，例如：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> person </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {name: </span><span style="color: #A5D6FF">"John"</span><span style="color: #C9D1D9">, age: </span><span style="color: #79C0FF">30</span><span style="color: #C9D1D9">};</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> person[</span><span style="color: #A5D6FF">"name"</span><span style="color: #C9D1D9">];</span></span></code></pre>
<ol start="4">
<li>函数声明</li>
</ol>
<p>在JavaScript中，可以使用function关键字来声明函数，例如：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">add</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> y;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>在JScript中，可以使用function关键字来声明函数，也可以使用function语句来声明函数，例如：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">add</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> y;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">sub</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> y;</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span></code></pre>
<ol start="5">
<li>正则表达式</li>
</ol>
<p>在JavaScript中，可以使用字面量来创建正则表达式，例如：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> pattern </span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF"> /hello/</span><span style="color: #FF7B72">i</span><span style="color: #C9D1D9">;</span></span></code></pre>
<p>在JScript中，需要使用RegExp对象来创建正则表达式，例如：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> pattern </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">RegExp</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"hello"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"i"</span><span style="color: #C9D1D9">);</span></span></code></pre>
<p>以上是JScript和JavaScript语法差别的几个方面。需要注意的是，在实际开发中，为了保证代码的兼容性和稳定性，应该尽量遵循ECMAScript规范，尽量不使用语法上的差异。</p>
<h2 id="user-9">user:</h2>
<p>jscript扫描文件夹</p>
<h2 id="assistant-9">assistant:</h2>
<p>在JScript中，可以使用FileSystemObject对象来扫描文件夹。FileSystemObject对象提供了许多方法和属性，可以用于访问和操作文件系统。</p>
<p>以下是一个示例代码，可以扫描指定文件夹，打印文件夹下所有文件和子文件夹的名称：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> fso </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Scripting.FileSystemObject"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">scanFolder</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">folder</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> files </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(folder.Files);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">files.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); files.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> file </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> files.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(file.Name);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> subfolders </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(folder.SubFolders);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">subfolders.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); subfolders.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> subfolder </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> subfolders.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(subfolder.Name);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">scanFolder</span><span style="color: #C9D1D9">(subfolder);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> folder </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fso.</span><span style="color: #D2A8FF">GetFolder</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Windows"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #D2A8FF">scanFolder</span><span style="color: #C9D1D9">(folder);</span></span></code></pre>
<p>本例首先创建了一个FileSystemObject对象，然后定义了一个名为<code>scanFolder</code>的函数，用于递归扫描指定文件夹。函数接受一个文件夹对象作为参数，使用Enumerator对象遍历文件夹下的所有文件和子文件夹，并使用console.log方法打印名称。</p>
<p>最后，使用GetFolder方法获取指定文件夹的对象，调用<code>scanFolder</code>函数开始扫描。</p>
<h2 id="user-10">user:</h2>
<p>jscript打印所有的网卡信息</p>
<h2 id="assistant-10">assistant:</h2>
<p>在JScript中，可以使用<code>WMI</code>（Windows Management Instrumentation）提供的对象访问系统信息，包括网卡信息。使用<code>WMI</code>可以方便地获取和操作系统资源和信息，但需要具有管理员权限。</p>
<p>以下是一个示例代码，可以使用<code>WMI</code>获取系统中所有网卡的信息：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> locator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WbemScripting.SWbemLocator"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> services </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> locator.</span><span style="color: #D2A8FF">ConnectServer</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> adapters </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> services.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"SELECT * FROM Win32_NetworkAdapter WHERE PhysicalAdapter=True"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(adapters);</span></span>
<span class="line"><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> adapter </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Name: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> adapter.Name);</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Adapter Type: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> adapter.AdapterType);</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"MAC Address: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> adapter.MACAddress);</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"IP Address: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getIPAddress</span><span style="color: #C9D1D9">(adapter));</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">" "</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getIPAddress</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">adapter</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> addresses </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> adapter.IPAddress;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> subnetMasks </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> adapter.IPSubnet;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ipValues </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(addresses);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> address </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        ipValues.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(address);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(subnetMasks);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> index </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> subnetMask </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ip </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ipValues[index];</span></span>
<span class="line"><span style="color: #C9D1D9">        ip </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"/"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getMaskLength</span><span style="color: #C9D1D9">(subnetMask);</span></span>
<span class="line"><span style="color: #C9D1D9">        ipValues[index] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ip;</span></span>
<span class="line"><span style="color: #C9D1D9">        index</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> ipValues.</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">", "</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getMaskLength</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">mask</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> binaryMask </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    mask </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> mask.</span><span style="color: #D2A8FF">split</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> b </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">parseInt</span><span style="color: #C9D1D9">(mask[i]).</span><span style="color: #D2A8FF">toString</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (b.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            b </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"0"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> b;</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">        binaryMask </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> b;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> binaryMask.</span><span style="color: #D2A8FF">replace</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">/0</span><span style="color: #FF7B72">+$</span><span style="color: #A5D6FF">/</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">).</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">;    </span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>本例首先创建了一个<code>SWbemLocator</code>对象，并使用ConnectServer方法连接到当前计算机。然后使用ExecQuery方法查询Win32_NetworkAdapter类，获取所有物理网卡的信息。</p>
<p>使用Enumerator对象迭代遍历每个网卡对象，并打印名称、类型、MAC地址和IP地址等信息。可以通过<code>IPAddress</code>和<code>IPSubnet</code>属性获取IP地址和子网掩码，需要注意的是，它们是数组，可能包含多个IP地址或子网掩码。因此，在<code>getIPAddress</code>函数中，需要遍历数组并逐一拼接IP地址和子网掩码，最终返回用逗号分隔的字符串。</p>
<p>最后，使用<code>getMaskLength</code>函数将子网掩码转换成CIDR格式的子网前缀长度。</p>
<h2 id="user-11">user:</h2>
<p>Jscript监控网络流量</p>
<h2 id="assistant-11">assistant:</h2>
<p>在JScript中，可以使用WMI（Windows Management Instrumentation）提供的对象监控网络流量。WMI提供了<code>Win32_PerfFormattedData_Tcpip_NetworkInterface</code>类，可以获取系统中所有网络接口的流量数据。</p>
<p>以下是一个示例代码，可以使用WMI监控网络流量的上传和下载速度：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> locator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WbemScripting.SWbemLocator"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> services </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> locator.</span><span style="color: #D2A8FF">ConnectServer</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> query </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"SELECT * FROM Win32_PerfFormattedData_Tcpip_NetworkInterface WHERE NOT Name LIKE '%total%'"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> interfaces </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> services.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(query);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {};</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> timerID </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">setInterval</span><span style="color: #C9D1D9">(getNetworkTraffic, </span><span style="color: #79C0FF">1000</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getNetworkTraffic</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {};</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(interfaces);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> iface </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> iface.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">        currData[name] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {recv: iface.BytesReceivedPerSec, send: iface.BytesSentPerSec};</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (Object.</span><span style="color: #D2A8FF">keys</span><span style="color: #C9D1D9">(prevData).</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> deltaTime </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">; </span><span style="color: #8B949E">// 时间间隔为1秒</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(interfaces);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> iface </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> iface.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevRecv </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> prevData[name].recv;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevSend </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> prevData[name].send;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currRecv </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData[name].recv;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currSend </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData[name].send;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> recvSpeed </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (currRecv </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> prevRecv) </span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9"> deltaTime;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> sendSpeed </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (currSend </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> prevSend) </span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9"> deltaTime;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(name </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" - Receive: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(recvSpeed) </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"/s, Send: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(sendSpeed) </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"/s"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    prevData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">bytes</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> units </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [</span><span style="color: #A5D6FF">"B/s"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"KB/s"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"MB/s"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"GB/s"</span><span style="color: #C9D1D9">];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> index </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (bytes </span><span style="color: #FF7B72">>=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1024</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> index </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> units.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        bytes </span><span style="color: #FF7B72">/=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1024</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        index</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> bytes.</span><span style="color: #D2A8FF">toFixed</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> units[index];</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>本例首先创建了一个<code>SWbemLocator</code>对象，并使用ConnectServer方法连接到当前计算机。然后使用ExecQuery方法查询<code>Win32_PerfFormattedData_Tcpip_NetworkInterface</code>类，获取系统中所有网络接口的监控数据。</p>
<p>定义一个<code>prevData</code>变量，用于存储上次获取的所有网络接口的流量数据。使用<code>setInterval</code>函数每隔1秒钟执行<code>getNetworkTraffic</code>函数，该函数会获取当前所有网络接口的流量数据，并计算上传和下载速度，最后打印到控制台。</p>
<p>在计算速度时，需要计算上一次获取数据和当前获取数据的时间差，然后将字节转换成带单位的速度字符串，用于打印输出。</p>
<p>最后需要注意的是，需要具有管理员权限才能使用WMI提供的对象。</p>
<h2 id="user-12">user:</h2>
<p>jscript监控内存使用</p>
<h2 id="assistant-12">assistant:</h2>
<p>在JScript中，可以使用WMI（Windows Management Instrumentation）提供的对象监控内存使用情况。WMI提供了<code>Win32_Process</code>和<code>Win32_PerfFormattedData_PerfProc_Process</code>类，可以获取与进程和内存有关的信息。</p>
<p>以下是一个示例代码，可以使用WMI监控内存使用量：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> locator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WbemScripting.SWbemLocator"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> services </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> locator.</span><span style="color: #D2A8FF">ConnectServer</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> query </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"SELECT * FROM Win32_Process WHERE Name like '%chrome%'"</span><span style="color: #C9D1D9">; </span><span style="color: #8B949E">// 监控Chrome进程的内存使用</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> processes </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> services.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(query);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> timerID </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">setInterval</span><span style="color: #C9D1D9">(getMemoryUsage, </span><span style="color: #79C0FF">1000</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getMemoryUsage</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {};</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(processes);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> process </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> process.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currMemoryUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getProcessMemoryUsage</span><span style="color: #C9D1D9">(process);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        currData[name] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currMemoryUsage;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (Object.</span><span style="color: #D2A8FF">keys</span><span style="color: #C9D1D9">(prevData).</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(processes);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> process </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> process.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevMemoryUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> prevData[name];</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currMemoryUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData[name];</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> memoryUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currMemoryUsage </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> prevMemoryUsage;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(name </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" - Memory Usage: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(memoryUsage));</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    prevData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getProcessMemoryUsage</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">process</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> query </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"SELECT * FROM Win32_PerfFormattedData_PerfProc_Process WHERE IDProcess="</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> process.ProcessId;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> data </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> services.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(query);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> memoryUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(data);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> item </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        memoryUsage </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> item.WorkingSetPrivate;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> memoryUsage;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">bytes</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> units </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [</span><span style="color: #A5D6FF">"B"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"KB"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"MB"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"GB"</span><span style="color: #C9D1D9">];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> index </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (bytes </span><span style="color: #FF7B72">>=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1024</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> index </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> units.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        bytes </span><span style="color: #FF7B72">/=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1024</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        index</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> bytes.</span><span style="color: #D2A8FF">toFixed</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> units[index];</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>本例首先创建了一个<code>SWbemLocator</code>对象，并使用ConnectServer方法连接到当前计算机。然后使用ExecQuery方法查询<code>Win32_Process</code>类，获取Chrome进程的信息，用于监控内存使用。</p>
<p>定义一个<code>prevData</code>变量，用于存储上次获取的Chrome进程的内存使用情况。使用<code>setInterval</code>函数每隔1秒钟执行<code>getMemoryUsage</code>函数，该函数会获取当前Chrome进程的内存使用情况，并计算内存使用量，最后打印到控制台。</p>
<p>在计算内存使用量时，需要查询<code>Win32_PerfFormattedData_PerfProc_Process</code>类，该类提供了进程的性能计数器数据，其中WorkingSetPrivate表示该进程独占的物理内存大小。</p>
<p>最后需要注意的是，需要具有管理员权限才能使用WMI提供的对象。</p>
<h2 id="user-13">user:</h2>
<p>jscript监控CPU</p>
<h2 id="assistant-13">assistant:</h2>
<p>在JScript中，可以使用WMI（Windows Management Instrumentation）提供的对象监控CPU使用情况。WMI提供了<code>Win32_PerfFormattedData_PerfOS_Processor</code>类，可以获取与CPU使用有关的信息。</p>
<p>以下是一个示例代码，可以使用WMI监控CPU使用量：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> locator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WbemScripting.SWbemLocator"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> services </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> locator.</span><span style="color: #D2A8FF">ConnectServer</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> query </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"SELECT * FROM Win32_PerfFormattedData_PerfOS_Processor WHERE Name='_Total'"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> processors </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> services.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(query);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> timerID </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">setInterval</span><span style="color: #C9D1D9">(getCPUUsage, </span><span style="color: #79C0FF">1000</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getCPUUsage</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {};</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(processors);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> processor </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> processor.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">        currData[name] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> processor.PercentProcessorTime;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (Object.</span><span style="color: #D2A8FF">keys</span><span style="color: #C9D1D9">(prevData).</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> deltaTime </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">; </span><span style="color: #8B949E">// 时间间隔为1秒</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(processors);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> processor </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> processor.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> prevData[name];</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData[name];</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> cpuUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (currUsage </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> prevUsage) </span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9"> deltaTime;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(name </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" - CPU Usage: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> cpuUsage.</span><span style="color: #D2A8FF">toFixed</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"%"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    prevData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>本例首先创建了一个<code>SWbemLocator</code>对象，并使用ConnectServer方法连接到当前计算机。然后使用ExecQuery方法查询<code>Win32_PerfFormattedData_PerfOS_Processor</code>类中<code>_Total</code>对象的信息，用于监控CPU使用情况。</p>
<p>定义一个<code>prevData</code>变量，用于存储上次获取的CPU使用情况。使用<code>setInterval</code>函数每隔1秒钟执行<code>getCPUUsage</code>函数，该函数会获取当前_CPU使用情况，并计算CPU使用量，最后打印到控制台。</p>
<p>在计算CPU使用量时，需要计算上一次获取数据和当前获取数据的时间差，然后根据CPU时间的百分比计算出CPU使用量。</p>
<p>最后需要注意的是，需要具有管理员权限才能使用WMI提供的对象。</p>
<h2 id="user-14">user:</h2>
<p>jscript监控硬盘</p>
<h2 id="assistant-14">assistant:</h2>
<p>在JScript中，可以使用WMI（Windows Management Instrumentation）提供的对象监控硬盘使用情况。WMI提供了<code>Win32_LogicalDisk</code>类，可以获取各个分区的使用情况。</p>
<p>以下是一个示例代码，可以使用WMI监控硬盘使用量：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> locator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WbemScripting.SWbemLocator"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> services </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> locator.</span><span style="color: #D2A8FF">ConnectServer</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> query </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"SELECT * FROM Win32_LogicalDisk WHERE DriveType=3"</span><span style="color: #C9D1D9">; </span><span style="color: #8B949E">// 监控本地磁盘的使用情况</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> disks </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> services.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(query);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> timerID </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">setInterval</span><span style="color: #C9D1D9">(getDiskUsage, </span><span style="color: #79C0FF">1000</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getDiskUsage</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {};</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(disks);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> disk </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> disk.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currFreeSpace </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> disk.FreeSpace;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currTotalSpace </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> disk.Size;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currTotalSpace </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> currFreeSpace;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currUsagePercentage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currUsage </span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9"> currTotalSpace </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">100</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        currData[name] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #A5D6FF">"FreeSpace"</span><span style="color: #C9D1D9">: currFreeSpace,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #A5D6FF">"TotalSpace"</span><span style="color: #C9D1D9">: currTotalSpace,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #A5D6FF">"Usage"</span><span style="color: #C9D1D9">: currUsage,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #A5D6FF">"UsagePercentage"</span><span style="color: #C9D1D9">: currUsagePercentage</span></span>
<span class="line"><span style="color: #C9D1D9">        };</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (Object.</span><span style="color: #D2A8FF">keys</span><span style="color: #C9D1D9">(prevData).</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumerator </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(disks);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (; </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumerator.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">(); enumerator.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> disk </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumerator.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> disk.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevFreeSpace </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> prevData[name].FreeSpace;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevTotalSpace </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> prevData[name].TotalSpace;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> prevUsagePercentage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> prevData[name].UsagePercentage;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currFreeSpace </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData[name].FreeSpace;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currTotalSpace </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData[name].TotalSpace;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currUsage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData[name].Usage;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currUsagePercentage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData[name].UsagePercentage;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> usageDifference </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currUsagePercentage </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> prevUsagePercentage;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(name </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" - Free Space: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(currFreeSpace) </span><span style="color: #FF7B72">+</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #A5D6FF">", Total Space: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(currTotalSpace) </span><span style="color: #FF7B72">+</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #A5D6FF">", Usage: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(currUsage) </span><span style="color: #FF7B72">+</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #A5D6FF">", Usage Percentage: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> currUsagePercentage.</span><span style="color: #D2A8FF">toFixed</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"%"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #A5D6FF">", Usage Difference: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> usageDifference.</span><span style="color: #D2A8FF">toFixed</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"%"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    prevData </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currData;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">formatSize</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">bytes</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> units </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [</span><span style="color: #A5D6FF">"B"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"KB"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"MB"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"GB"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"TB"</span><span style="color: #C9D1D9">];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> index </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (bytes </span><span style="color: #FF7B72">>=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1024</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> index </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> units.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        bytes </span><span style="color: #FF7B72">/=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1024</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        index</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> bytes.</span><span style="color: #D2A8FF">toFixed</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> units[index];</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>本例首先创建了一个<code>SWbemLocator</code>对象，并使用ConnectServer方法连接到当前计算机。然后使用ExecQuery方法查询<code>Win32_LogicalDisk</code>类，获取本地磁盘的信息，用于监控磁盘使用情况。</p>
<p>定义一个<code>prevData</code>变量，用于存储上次获取的磁盘使用情况。使用<code>setInterval</code>函数每隔1秒钟执行<code>getDiskUsage</code>函数，该函数会获取当前磁盘的使用情况，并计算磁盘使用量，最后打印到控制台。</p>
<p>在计算磁盘使用量时，需要计算磁盘的总空间和可用空间，并计算已使用空间和使用百分比。</p>
<p>最后需要注意的是，需要具有管理员权限才能使用WMI提供的对象。</p>
<h2 id="user-15">user:</h2>
<p>jscript可以开发windows服务吗</p>
<h2 id="assistant-15">assistant:</h2>
<p>是的，可以使用JScript来编写Windows服务。Windows服务是一种在后台运行的应用程序，可以在Windows启动时启动并一直运行。使用JScript编写Windows服务需要先将JScript转换为Windows服务，然后安装和启动该服务。</p>
<p>以下是一个简单的示例，演示如何使用JScript编写Windows服务：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ServiceName </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"HelloWorldService"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ServiceDisplayName </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"Hello World Service"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ServiceDescription </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"This is a simple demonstration of a Windows service written in JScript."</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> Service </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> () {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">message</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> fso </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Scripting.FileSystemObject"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> logFile </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fso.</span><span style="color: #D2A8FF">OpenTextFile</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">hello-world-service.log"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">); </span><span style="color: #8B949E">// 以追加模式打开日志文件</span></span>
<span class="line"><span style="color: #C9D1D9">        logFile.</span><span style="color: #D2A8FF">Write</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Date</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">toLocaleString</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" - "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> message </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\r\n</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        logFile.</span><span style="color: #D2A8FF">Close</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">OnStart</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> () {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Service started."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">setInterval</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> () {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Hello World!"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        }, </span><span style="color: #79C0FF">5000</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">OnStop</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> () {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Service stopped."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ServiceHost </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> () {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ServiceControl </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"SERVICE_ACCEPT_STOP"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"SERVICE_CONTROL_STOP"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"SERVICE_STOPPED"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">2</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> ServiceStatus </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"dwServiceType"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">16</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"dwCurrentState"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"dwControlsAccepted"</span><span style="color: #C9D1D9">: ServiceControl.</span><span style="color: #79C0FF">SERVICE_ACCEPT_STOP</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"dwWin32ExitCode"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"dwServiceSpecificExitCode"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"dwCheckPoint"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"dwWaitHint"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">0</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> service </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Service</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ServiceMain</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">argc</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">argv</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> serviceStatusHandle </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> status </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ServiceStatus;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        serviceStatusHandle </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">RegisterServiceCtrlHandler</span><span style="color: #C9D1D9">(ServiceName, Handler);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (serviceStatusHandle) {</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwCurrentState </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwCheckPoint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwWaitHint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwControlsAccepted </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ServiceControl.</span><span style="color: #79C0FF">SERVICE_ACCEPT_STOP</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">SetServiceStatus</span><span style="color: #C9D1D9">(serviceStatusHandle, status);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            service.</span><span style="color: #D2A8FF">OnStart</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            status.dwCurrentState </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwCheckPoint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwWaitHint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwControlsAccepted </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ServiceControl.</span><span style="color: #79C0FF">SERVICE_ACCEPT_STOP</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">SetServiceStatus</span><span style="color: #C9D1D9">(serviceStatusHandle, status);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (status.dwCurrentState </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">Sleep</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">5000</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            service.</span><span style="color: #D2A8FF">OnStop</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            status.dwCurrentState </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ServiceStatus.</span><span style="color: #79C0FF">SERVICE_STOPPED</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwCheckPoint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwWaitHint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            status.dwControlsAccepted </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">SetServiceStatus</span><span style="color: #C9D1D9">(serviceStatusHandle, status);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Handler</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">controlCode</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> status </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ServiceStatus;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">switch</span><span style="color: #C9D1D9"> (controlCode) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> ServiceControl.</span><span style="color: #79C0FF">SERVICE_CONTROL_STOP</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">                status.dwCurrentState </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ServiceStatus.</span><span style="color: #79C0FF">SERVICE_STOP_PENDING</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                status.dwCheckPoint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                status.dwWaitHint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">5000</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                status.dwControlsAccepted </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">SetServiceStatus</span><span style="color: #C9D1D9">(serviceStatusHandle, status);</span></span>
<span class="line"><span style="color: #C9D1D9">                status.dwCurrentState </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ServiceStatus.</span><span style="color: #79C0FF">SERVICE_STOPPED</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                status.dwCheckPoint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                status.dwWaitHint </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                status.dwControlsAccepted </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">SetServiceStatus</span><span style="color: #C9D1D9">(serviceStatusHandle, status);</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        Main: ServiceMain</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">try</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> svc </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ServiceHost</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    svc.</span><span style="color: #D2A8FF">Main</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">} </span><span style="color: #FF7B72">catch</span><span style="color: #C9D1D9"> (e) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> fso </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Scripting.FileSystemObject"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> logFile </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fso.</span><span style="color: #D2A8FF">OpenTextFile</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">hello-world-service.log"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">); </span><span style="color: #8B949E">// 以追加模式打开日志文件</span></span>
<span class="line"><span style="color: #C9D1D9">    logFile.</span><span style="color: #D2A8FF">Write</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Date</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">toLocaleString</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" - "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> e.message </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\r\n</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    logFile.</span><span style="color: #D2A8FF">Close</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>本例定义了一个名为”HelloWorldService”的Windows服务，在服务启动后每隔5秒向日志文件输出一条”Hello World!”消息。</p>
<p>服务定义为一个名为Service的对象，其中包含OnStart和OnStop方法，在服务启动和停止后分别调用。OnStart方法使用setInterval来定期执行输出消息任务。log函数用于将消息写入日志文件中。</p>
<p>服务主机定义为一个名为ServiceHost的对象，其中包含ServiceControl和ServiceStatus对象，用于定义服务的控制和状态。ServiceMain方法是服务的入口点，其中创建服务实例并调用OnStart和OnStop方法。Handler方法用于响应服务控制请求，例如窗口关闭命令。</p>
<p>最后，在捕获任何异常后启动ServiceHost实例。要安装服务，请使用sc.exe等工具将该脚本转换为Windows服务，然后使用服务管理器安装和启动服务。</p>
<h2 id="user-16">user:</h2>
<p>jscript操作sqlite</p>
<h2 id="assistant-16">assistant:</h2>
<p>在JScript中可以使用ActiveXObject对象操作SQLite。SQLite是一种轻量级的关系型数据库，适用于基于文件或内存的应用程序。</p>
<p>SQLite的AxtiveXObject代码示例：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">//打开或创建数据库</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> conn </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"ADODB.Connection"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> testPath </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Test</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">demo.db"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> connString </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"Provider=SQLite3OLE.DBProv.1;Data Source="</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> testPath;</span></span>
<span class="line"><span style="color: #C9D1D9">conn.</span><span style="color: #D2A8FF">Open</span><span style="color: #C9D1D9">(connString);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//创建数据表</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> tableName </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"DemoTable"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">conn.</span><span style="color: #D2A8FF">Execute</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"CREATE TABLE IF NOT EXISTS "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> tableName </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"(Id INTEGER PRIMARY KEY AUTOINCREMENT, Name TEXT)"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//插入数据</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"Test Data"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">conn.</span><span style="color: #D2A8FF">Execute</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"INSERT INTO "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> tableName </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"(Name) VALUES('"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"')"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//查询数据</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> rs </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"ADODB.Recordset"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">rs.</span><span style="color: #D2A8FF">Open</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"SELECT * FROM "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> tableName, conn);</span></span>
<span class="line"><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">rs.</span><span style="color: #79C0FF">EOF</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> rs.</span><span style="color: #D2A8FF">Fields</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Id"</span><span style="color: #C9D1D9">).Value;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> rs.</span><span style="color: #D2A8FF">Fields</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Name"</span><span style="color: #C9D1D9">).Value;</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"ID="</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">", Name="</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> name);</span></span>
<span class="line"><span style="color: #C9D1D9">    rs.</span><span style="color: #D2A8FF">MoveNext</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//关闭数据库连接</span></span>
<span class="line"><span style="color: #C9D1D9">rs.</span><span style="color: #D2A8FF">Close</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">conn.</span><span style="color: #D2A8FF">Close</span><span style="color: #C9D1D9">();</span></span></code></pre>
<p>该示例代码演示了如何使用ActiveXObject操作SQLite数据库。首先，创建一个连接对象并打开或创建数据库文件。在本例中，使用的SQLite3OLE.DBProv.1提供程序。然后，使用Execute方法创建一个数据表，并插入一条数据记录。最后，使用Recordset对象执行查询操作，并输出结果到控制台上。最后，关闭连接。</p>
<p>请注意，SQLite日常运营和维护的最佳方式是使用专业的SQLite库，而不是直接使用ActiveXObject访问它。SQLite官方有多种编程语言的API，而且有大量第三方库以及ORM框架，可以轻松地处理SQLite数据库。</p>
<h2 id="user-17">user:</h2>
<p>jscript读取系统日志</p>
<h2 id="assistant-17">assistant:</h2>
<p>在JScript中，可以使用系统日志提供程序（系统事件日志）来读取Windows操作系统的系统日志记录。以下是一个例子，演示如何读取系统日志中的事件并输出到控制台上：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> eventLog </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"LogQuery.LogQuery"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> query </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"SELECT * FROM System"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> dateFrom </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"2021-01-01"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> dateTo </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"2021-06-01"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> queryString </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"WHERE EventTime BETWEEN timestamp('"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> dateFrom </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"') AND timestamp('"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> dateTo </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"')"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">query </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> queryString;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> recordSet </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> eventLog.</span><span style="color: #D2A8FF">Execute</span><span style="color: #C9D1D9">(query);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">recordSet.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> fields </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> recordSet.</span><span style="color: #D2A8FF">getRecord</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">toNativeArray</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> eventType </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fields[</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> eventSource </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fields[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> eventMessage </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fields[</span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">];</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(eventType </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">": "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> eventSource </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" - "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> eventMessage);</span></span>
<span class="line"><span style="color: #C9D1D9">    recordSet.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"><span style="color: #C9D1D9">recordSet.</span><span style="color: #D2A8FF">close</span><span style="color: #C9D1D9">();</span></span></code></pre>
<p>该示例代码演示了如何使用LogQuery.LogQuery对象来执行SQL查询，并将查询结果输出到控制台上。在查询中，WHERE子句被用来筛选出指定时间段（dateFrom和dateTo之间）的日志记录。在此例子中，查询了系统日志中的所有事件（SELECT * FROM System）。</p>
<p>LogQuery.LogQuery的Execute方法会返回一个Recordset对象。Recordset对象可以使用toNativeArray()方法来获取结果集中的行记录。在本例中，通过Recordset对象的moveNext()方法来逐个迭代事件，并输出到控制台上。</p>
<p>这里使用了LogQuery对象，但还需要在计算机上安装Windows支持组件，例如“Windows Management Framework”和“Windows Vista和更高版本的.NET Framework”和“Log Parser 2.2”。这样，就可以引用LogQuery对象并使用它来查询系统日志了。</p>
<p>需要注意的是，系统日志包含大量的信息，因此在生产环境下，最好结合过滤器使用查询来缩小查询范围，而不是查询所有系统日志。</p>
<h2 id="user-18">user:</h2>
<p>查看windows的登录日志</p>
<h2 id="assistant-18">assistant:</h2>
<p>在Windows操作系统中，可以使用Event Viewer（事件查看器）工具查看登录日志。登录日志中会记录每次用户登录的时间、用户名、计算机名和登录类型等详细信息。以下是在Windows Server 2016上查看登录日志的步骤：</p>
<p>1.按下Win+X组合键，选择“Event Viewer”。</p>
<p>2.在左侧窗格中，展开“Windows Logs”并选择“Security”。</p>
<p>3.在右侧窗格中，将鼠标滚动到最下方，或者使用键盘快捷键“Ctrl + End”跳转到最下面。</p>
<p>4.在最下方，就可以看到最新的用户登录日志记录。</p>
<p>5.单击任意一条登录日志记录，就可以看到该用户的登录详细信息，包括登录时间、用户名、计算机名、登录类型等信息。</p>
<p>如果希望对登录日志进行详细的过滤和搜索，则可以在事件查看器中使用“Filter Current Log”或“Find”功能。可以使用这些功能来查找特定用户的登录操作、特定计算机的登录操作或特定时间窗口内的登录操作等信息。</p>
<h2 id="user-19">user:</h2>
<p>Jscript查看windows的登录记录</p>
<h2 id="assistant-19">assistant:</h2>
<p>在JScript中，也可以使用WMI（Windows Management Instrumentation，Windows管理规范）来查看Windows的登录记录。以下是一个示例代码，演示如何使用WMI查询最近的登录记录：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> strComputer </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"."</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> strNamespace </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"root</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">CIMV2"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> strQuery </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"SELECT * FROM Win32_NetworkLoginProfile"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> objWMIService </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">GetObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"winmgmts:"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #A5D6FF">"{impersonationLevel=impersonate}!</span><span style="color: #79C0FF">\\\\</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> strComputer </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> strNamespace);</span></span>
<span class="line"><span style="color: #C9D1D9"> </span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> colItems </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> objWMIService.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(strQuery);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> enumItems </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(colItems);</span></span>
<span class="line"><span style="color: #C9D1D9"> </span></span>
<span class="line"><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">enumItems.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> objItem </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> enumItems.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> Date </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> objItem.LastLogon;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> User </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> objItem.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> Domain </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> objItem.Domain;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> Type </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> objItem.LoginType;</span></span>
<span class="line"><span style="color: #C9D1D9"> </span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Date: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> Date </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">", User: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> User </span><span style="color: #FF7B72">+</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #A5D6FF">", Domain: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> Domain </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">", Type: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> Type);</span></span>
<span class="line"><span style="color: #C9D1D9">    enumItems.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>这个示例代码将查询Win32_NetworkLoginProfile类中的属性，该类包含了有关Windows网络登录配置文件中的最新登入的信息。在JScript中，使用WMI来访问系统和网络信息通常需要使用GetObject和ExecQuery方法。</p>
<p>这个例子中，查询结果包括每个登录记录的日期、用户名、域和类型等信息。在while循环中，通过枚举器来循环遍历结果，并输出到控制台上。注意，需要使用Windows管理员权限来运行JScript程序来访问WMI信息。</p>
<h2 id="user-20">user:</h2>
<p>jscript操作防火墙</p>
<h2 id="assistant-20">assistant:</h2>
<p>在JScript中，可以使用Windows Script Host (WSH) 对Windows防火墙进行管理。以下是一个示例代码，演示如何使用WSH对象管理防火墙：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">//创建WSH Shell对象</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> shell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WScript.Shell"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//启用防火墙</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"netsh firewall set opmode enable"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//禁用防火墙</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"netsh firewall set opmode disable"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//启用防火墙特定端口</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"netsh firewall add portopening TCP 80 </span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">Web Port</span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//禁用防火墙特定端口</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"netsh firewall delete portopening TCP 80"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//启用防火墙特定应用程序访问</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"netsh firewall add allowedprogram </span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Program Files</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyApp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyApp.exe</span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF"> MyApp ENABLE"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//禁用防火墙特定应用程序访问</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"netsh firewall delete allowedprogram </span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Program Files</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyApp</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">MyApp.exe</span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9">);</span></span></code></pre>
<p>在这个例子中，我们首先创建了一个WSH Shell对象。然后，我们使用shell.Run方法来执行Windows命令来管理防火墙。</p>
<p>通过执行<code>netsh firewall set opmode enable/disable</code>，可以启用或禁用防火墙。通过执行<code>netsh firewall add/delete portopening TCP 80</code>，可以启用或禁用特定的端口。通过执行<code>netsh firewall add/delete allowedprogram "程序完整路径" "程序名称" ENABLE/DISABLE</code>，可以允许或阻止特定的应用程序访问Internet。</p>
<p>需要注意的是，使用JScript管理Windows防火墙需要具有管理员权限。此外，在一些较新版本的Windows中，也可能会使用更加先进和安全的防火墙，如Windows Defender防火墙。此时，可能需要更加专业的管理工具和技能来实现操作。</p>
<h2 id="user-21">user:</h2>
<p>windows如何查看是否被攻击</p>
<h2 id="assistant-21">assistant:</h2>
<p>Windows系统如何查看是否被攻击，以下是一些常见的指标和方法：</p>
<ol>
<li>
<p>查看系统日志：可以打开“事件查看器”应用程序，选择“Windows日志”中的“安全”日志，查找是否有登录失败、帐号被锁定和异常登录等异常记录。这些记录可能是黑客对系统进行暴力破解或密码攻击的结果。</p>
</li>
<li>
<p>检查可疑的进程：通过任务管理器或资源监视器等工具查看是否存在非法进程或恶意软件。</p>
</li>
<li>
<p>检查网络连接：查看是否存在异常的网络连接或访问行为，可以使用命令行工具如netstat、TCPView或Wireshark等。这些工具可以显示当前所有的网络连接，包括远程IP地址、端口号和数据传输量等信息，也可以检查网络流量是否受到异常的影响。</p>
</li>
<li>
<p>检查文件和目录的变化：使用文件监视器或系统检测软件，检查是否有新增或修改的系统文件或目录，或是否存在异常的文件和文件夹。同时还可以查看文件的访问权限和修改时间等信息。</p>
</li>
<li>
<p>检查系统更新和安全补丁：最新的安全补丁可以修复系统中已知的漏洞，提高系统的安全性。注意检查系统的更新历史记录，查看是否存在未安装的安全补丁。</p>
</li>
</ol>
<p>需要注意的是，这些检查指标可能都不能全面检查出系统是否受到攻击。因此，建议使用安全软件和定期的漏洞扫描，以保障系统的安全。同时也需要注意定期备份重要数据，以备系统受到攻击的损失。</p>
<h2 id="user-22">user:</h2>
<p>jscript监控键盘输入</p>
<h2 id="assistant-22">assistant:</h2>
<p>JScript可以通过Windows Script Host (WSH) 对计算机系统进行访问，因此可以使用WSH来监控键盘输入。实现的方法主要是通过创建钩子来截获键盘事件。</p>
<p>以下是一个示例代码，演示如何使用WSH对象创建键盘钩子并监控键盘输入：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">//创建WSH Shell对象</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> shell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WScript.Shell"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定义钩子回调函数</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">OnKeyDown</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">keyCode</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">scanCode</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">flags</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> charCode </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> String.</span><span style="color: #D2A8FF">fromCharCode</span><span style="color: #C9D1D9">(keyCode).</span><span style="color: #D2A8FF">toLowerCase</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//将键盘输入输出到控制台窗口</span></span>
<span class="line"><span style="color: #C9D1D9">    WScript.</span><span style="color: #D2A8FF">Echo</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Key Down: "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> charCode);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//创建键盘钩子</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> hook </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> shell.</span><span style="color: #D2A8FF">RegRead</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"HKEY_CURRENT_USER</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Software</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Microsoft</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Windows</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">CurrentVersion</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Run</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">hook"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (hook </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//注册键盘钩子</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> scriptPath </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> WScript.ScriptFullName;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> command </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> scriptPath </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF"> hook"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    shell.</span><span style="color: #D2A8FF">RegWrite</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"HKEY_CURRENT_USER</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Software</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Microsoft</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Windows</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">CurrentVersion</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Run</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">hook"</span><span style="color: #C9D1D9">, command);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> hookHandle </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"mshta.exe javascript:var%20o%20=%20GetObject('script:"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> scriptPath </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"');%20o.OnHook();%20window.close();"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (hookHandle </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        WScript.</span><span style="color: #D2A8FF">Quit</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//监控键盘输入</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">OnHook</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> user32 </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> WScript.</span><span style="color: #D2A8FF">CreateObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"user32.dll"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> hwnd </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> user32.</span><span style="color: #D2A8FF">GetForegroundWindow</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> kernel32 </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> WScript.</span><span style="color: #D2A8FF">CreateObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"kernel32.dll"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> hModule </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> kernel32.</span><span style="color: #D2A8FF">GetModuleHandle</span><span style="color: #C9D1D9">(); </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> hookProc </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> kernel32.</span><span style="color: #D2A8FF">GetProcAddress</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"kernel32.dll"</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"OnKeyDown"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> threadId </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> user32.</span><span style="color: #D2A8FF">GetWindowThreadProcessId</span><span style="color: #C9D1D9">(hwnd)[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> hookHandle </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> user32.</span><span style="color: #D2A8FF">SetWindowsHookEx</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">13</span><span style="color: #C9D1D9">, hookProc, hModule, threadId);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (</span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//保持脚本运行</span></span>
<span class="line"><span style="color: #C9D1D9">        WScript.</span><span style="color: #D2A8FF">Sleep</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">100</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>在这个例子中，我们首先创建了一个WSH Shell对象。然后，我们定义了一个钩子回调函数OnKeyDown来监控键盘输入。该函数会将按键的字符代码输出到控制台窗口。</p>
<p>在这个例子中，我们创建了一个键盘钩子，使用了Windows系统中的user32.dll和kernel32.dll库。在hook注册时，我们将脚本的名称和参数添加到Windows的运行目录中，并通过执行HTA文件来激活键盘钩子。在OnHook函数中，我们使用user32的函数GetForegroundWindow()获取当前窗口句柄，并将其传递给SetWindowsHookEx()函数注册钩子。</p>
<p>需要注意的是，键盘钩子可以用于监视用户的输入，但也可能被恶意程序用于窃取敏感信息。因此，使用钩子进行键盘监控需要谨慎考虑，应妥善保护用户隐私。</p>
<h2 id="user-23">user:</h2>
<p>jscript开发一个俄罗斯方块游戏</p>
<h2 id="assistant-23">assistant:</h2>
<p>下面是使用JScript实现俄罗斯方块游戏的示例代码：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">//定义方块的形状和颜色</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> blocks </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [</span></span>
<span class="line"><span style="color: #C9D1D9">    {shape: [[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">], [</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">]], color: </span><span style="color: #A5D6FF">"yellow"</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">    {shape: [[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">]], color: </span><span style="color: #A5D6FF">"red"</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">    {shape: [[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">], [</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">], [</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">]], color: </span><span style="color: #A5D6FF">"blue"</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">    {shape: [[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">], [</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">], [</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">]], color: </span><span style="color: #A5D6FF">"green"</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">    {shape: [[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">], [</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">]], color: </span><span style="color: #A5D6FF">"purple"</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">    {shape: [[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">], [</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">]], color: </span><span style="color: #A5D6FF">"orange"</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">    {shape: [[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">], [</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">]], color: </span><span style="color: #A5D6FF">"pink"</span><span style="color: #C9D1D9">}</span></span>
<span class="line"><span style="color: #C9D1D9">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定义游戏区域的大小</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> boardWidth </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">10</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> boardHeight </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">20</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定义游戏区域</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> board </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [];</span></span>
<span class="line"><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> boardHeight; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    board[i] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> boardWidth; j</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        board[i][j] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定义当前方块和下一个方块</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> currentBlock </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> nextBlock </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定义游戏状态</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> isGameOver </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> isPaused </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定义游戏分数</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> score </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//获取游戏区域的元素</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> boardElement </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> document.</span><span style="color: #D2A8FF">getElementById</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"board"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//创建游戏区域的表格</span></span>
<span class="line"><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> boardHeight; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> row </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> boardElement.</span><span style="color: #D2A8FF">insertRow</span><span style="color: #C9D1D9">(i);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> boardWidth; j</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> cell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> row.</span><span style="color: #D2A8FF">insertCell</span><span style="color: #C9D1D9">(j);</span></span>
<span class="line"><span style="color: #C9D1D9">        cell.className </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"cell"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        cell.</span><span style="color: #D2A8FF">setAttribute</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"data-row"</span><span style="color: #C9D1D9">, i);</span></span>
<span class="line"><span style="color: #C9D1D9">        cell.</span><span style="color: #D2A8FF">setAttribute</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"data-col"</span><span style="color: #C9D1D9">, j);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//显示游戏分数</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> scoreElement </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> document.</span><span style="color: #D2A8FF">getElementById</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"score"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">scoreElement.innerHTML </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> score;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//按键事件处理函数</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">onKeyDown</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">event</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (isGameOver </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> isPaused) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">switch</span><span style="color: #C9D1D9"> (event.keyCode) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">37</span><span style="color: #C9D1D9">: </span><span style="color: #8B949E">//向左</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">move</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">-</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">38</span><span style="color: #C9D1D9">: </span><span style="color: #8B949E">//变形</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">rotate</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">39</span><span style="color: #C9D1D9">: </span><span style="color: #8B949E">//向右</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">move</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">40</span><span style="color: #C9D1D9">: </span><span style="color: #8B949E">//加速下落</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">drop</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">32</span><span style="color: #C9D1D9">: </span><span style="color: #8B949E">//暂停或继续</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">pause</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//设置键盘事件监听器</span></span>
<span class="line"><span style="color: #C9D1D9">document.</span><span style="color: #D2A8FF">addEventListener</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"keydown"</span><span style="color: #C9D1D9">, onKeyDown);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//开始游戏</span></span>
<span class="line"><span style="color: #D2A8FF">startGame</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//开始游戏函数</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">startGame</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    isGameOver </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//创建下一个方块</span></span>
<span class="line"><span style="color: #C9D1D9">    nextBlock </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">generateBlock</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//初始化游戏区域</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">clearBoard</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//循环播放游戏</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">isGameOver) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//初始化当前方块</span></span>
<span class="line"><span style="color: #C9D1D9">        currentBlock </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> nextBlock;</span></span>
<span class="line"><span style="color: #C9D1D9">        nextBlock </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">generateBlock</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//判断当前方块是否可以出现在游戏区域中</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #D2A8FF">canMoveTo</span><span style="color: #C9D1D9">(currentBlock, Math.</span><span style="color: #D2A8FF">floor</span><span style="color: #C9D1D9">(boardWidth </span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">gameOver</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//将当前方块放置在游戏区域的中心位置</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">moveBlock</span><span style="color: #C9D1D9">(currentBlock, Math.</span><span style="color: #D2A8FF">floor</span><span style="color: #C9D1D9">(boardWidth </span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//循环下落当前方块</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (</span><span style="color: #D2A8FF">canMoveTo</span><span style="color: #C9D1D9">(currentBlock, currentBlock.x, currentBlock.y </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">moveBlock</span><span style="color: #C9D1D9">(currentBlock, currentBlock.x, currentBlock.y </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//将当前方块的方块块加入游戏区域中</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">addToBoard</span><span style="color: #C9D1D9">(currentBlock);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//消除满行，并计算分数</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> count </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">clearFullRows</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        score </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> count </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> count;</span></span>
<span class="line"><span style="color: #C9D1D9">        scoreElement.innerHTML </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> score;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//清空当前方块</span></span>
<span class="line"><span style="color: #C9D1D9">        currentBlock </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//按照概率生成随机方块</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">generateBlock</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> index </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> Math.</span><span style="color: #D2A8FF">floor</span><span style="color: #C9D1D9">(Math.</span><span style="color: #D2A8FF">random</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> blocks.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        shape: blocks[index].shape,</span></span>
<span class="line"><span style="color: #C9D1D9">        color: blocks[index].color,</span></span>
<span class="line"><span style="color: #C9D1D9">        x: </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        y: </span><span style="color: #79C0FF">0</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//清空游戏区域</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">clearBoard</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> boardHeight; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> boardWidth; j</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            board[i][j] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> cell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> boardElement.rows[i].cells[j];</span></span>
<span class="line"><span style="color: #C9D1D9">            cell.style.backgroundColor </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//判断方块是否能够移动到指定位置</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">canMoveTo</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">block</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> block.shape.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> block.shape[i].</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; j</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (block.shape[i][j] </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> row </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> y </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> i;</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> col </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> j;</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (row </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> row </span><span style="color: #FF7B72">>=</span><span style="color: #C9D1D9"> boardHeight </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> col </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> col </span><span style="color: #FF7B72">>=</span><span style="color: #C9D1D9"> boardWidth </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> board[row][col] </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                }</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//将方块移动到指定位置</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">moveBlock</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">block</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    block.x </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x;</span></span>
<span class="line"><span style="color: #C9D1D9">    block.y </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> y;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> block.shape.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> block.shape[i].</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; j</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (block.shape[i][j] </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> row </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> y </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> i;</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> col </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> j;</span></span>
<span class="line"><span style="color: #C9D1D9">                board[row][col] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> block.color;</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> cell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> boardElement.rows[row].cells[col];</span></span>
<span class="line"><span style="color: #C9D1D9">                cell.style.backgroundColor </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> block.color;</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//将方块放置在游戏区域中</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">addToBoard</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">block</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> block.shape.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> block.shape[i].</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; j</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (block.shape[i][j] </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> row </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> block.y </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> i;</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> col </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> block.x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> j;</span></span>
<span class="line"><span style="color: #C9D1D9">                board[row][col] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> block.color;</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//变形方块</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">rotate</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">currentBlock) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//旋转90度</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> newShape </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> currentBlock.shape[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">].</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> newRow </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [];</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currentBlock.shape.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">>=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j</span><span style="color: #FF7B72">--</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            newRow.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(currentBlock.shape[j][i]);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">        newShape.</span><span style="color: #D2A8FF">push</span><span style="color: #C9D1D9">(newRow);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//判断是否可以变形</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #D2A8FF">canMoveTo</span><span style="color: #C9D1D9">({shape: newShape}, currentBlock.x, currentBlock.y)) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//清除旧位置</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">moveBlock</span><span style="color: #C9D1D9">(currentBlock, </span><span style="color: #FF7B72">-</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">, </span><span style="color: #FF7B72">-</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//更新形状并移动到新位置</span></span>
<span class="line"><span style="color: #C9D1D9">        currentBlock.shape </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> newShape;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">moveBlock</span><span style="color: #C9D1D9">(currentBlock, currentBlock.x, currentBlock.y);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//移动方块</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">move</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">direction</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">currentBlock) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> newX </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currentBlock.x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> direction;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #D2A8FF">canMoveTo</span><span style="color: #C9D1D9">(currentBlock, newX, currentBlock.y)) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">moveBlock</span><span style="color: #C9D1D9">(currentBlock, newX, currentBlock.y);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//下落方块</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">drop</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">currentBlock) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> newY </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> currentBlock.y;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (</span><span style="color: #D2A8FF">canMoveTo</span><span style="color: #C9D1D9">(currentBlock, currentBlock.x, newY </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)) {</span></span>
<span class="line"><span style="color: #C9D1D9">        newY</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">moveBlock</span><span style="color: #C9D1D9">(currentBlock, currentBlock.x, newY);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//消除满行的方块</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">clearFullRows</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> count </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> boardHeight </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">>=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">--</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> isFull </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> boardWidth; j</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (board[i][j] </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                isFull </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (isFull) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #8B949E">//删除一行并在顶部插入一行空白行</span></span>
<span class="line"><span style="color: #C9D1D9">            board.</span><span style="color: #D2A8FF">splice</span><span style="color: #C9D1D9">(i, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">            board.</span><span style="color: #D2A8FF">unshift</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Array</span><span style="color: #C9D1D9">(boardWidth).</span><span style="color: #D2A8FF">fill</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">));</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> j </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; j </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> boardWidth; j</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> cell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> boardElement.rows[i].cells[j];</span></span>
<span class="line"><span style="color: #C9D1D9">                cell.style.backgroundColor </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">            i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">            count</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> count;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//游戏结束</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">gameOver</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    isGameOver </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">alert</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"游戏结束，您的分数是："</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> score);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//暂停或继续游戏</span></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">pause</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    isPaused </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">isPaused;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (isPaused) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">alert</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"游戏已暂停"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">alert</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"游戏已继续"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>这个代码主要做了以下事情：</p>
<p>1.定义了俄罗斯方块的形状和颜色；
2.初始化游戏区域、当前方块和下一个方块；
3.创建按键事件处理函数，实现方块的移动、变形和下落等功能；
4.开始游戏循环，使当前方块下落直到不能下落或到达游戏区域底部；
5.判断当前方块能否放置到游戏区域中，并将相应的颜色方块块添加到游戏区域中；
6.消除满行方块并更新分数；
7.重复步骤4-6，直到游戏结束。</p>
<p>这个示例代码可以通过HTML页面嵌入到网页中，使用CSS样式设置游戏界面样式，通过JS代码控制游戏逻辑，实现一个基于JScript的俄罗斯方块游戏。</p>
<h2 id="user-24">user:</h2>
<p>jscript监控网络端口并关闭指定端口</p>
<h2 id="assistant-24">assistant:</h2>
<p>JScript可以使用Windows Script Host (WSH) 对计算机系统进行访问，因此可以使用WSH的对象创建一个能够监控网络端口并关闭指定端口的程序。</p>
<p>以下是一个基于JScript的示例代码，演示如何使用WSH对象监控网络端口并关闭指定端口：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">//创建WSH Shell对象</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> shell </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"WScript.Shell"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定义需要关闭的端口数组</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> targetPorts </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [</span><span style="color: #79C0FF">80</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">8080</span><span style="color: #C9D1D9">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//启动端口监听程序</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> processHandle </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"cmd.exe /c netstat -ano"</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//设置标志变量</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> isMonitoring </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定时检查网络端口</span></span>
<span class="line"><span style="color: #D2A8FF">setTimeout</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (isMonitoring) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//判断是否有网络端口被占用</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> output </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> shell.</span><span style="color: #D2A8FF">Exec</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"cmd.exe /c netstat -ano"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> isPortOpen </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">output.AtEndOfStream) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> line </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> output.</span><span style="color: #D2A8FF">ReadLine</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> targetPorts.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (line.</span><span style="color: #D2A8FF">indexOf</span><span style="color: #C9D1D9">(targetPorts[i].</span><span style="color: #D2A8FF">toString</span><span style="color: #C9D1D9">()) </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">-</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                    isPortOpen </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                }</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//如果端口被占用，强制关闭进程</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (isPortOpen) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> targetPorts.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> cmd </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"cmd.exe /c FOR /F </span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">tokens=5</span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF"> %P in ('netstat -a -n -o ^| findstr "</span></span>
<span class="line"><span style="color: #C9D1D9">                          </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> targetPorts[i] </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"') do taskkill /F /PID %P"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                shell.</span><span style="color: #D2A8FF">Run</span><span style="color: #C9D1D9">(cmd, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">//等待一段时间后再次检查</span></span>
<span class="line"><span style="color: #C9D1D9">        WScript.</span><span style="color: #D2A8FF">Sleep</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1000</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}, </span><span style="color: #79C0FF">500</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//关闭端口监听程序</span></span>
<span class="line"><span style="color: #C9D1D9">shell.</span><span style="color: #D2A8FF">Exec</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"cmd.exe /c taskkill /F /PID "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> processHandle.ProcessID);</span></span>
<span class="line"><span style="color: #C9D1D9">isMonitoring </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span></code></pre>
<p>这个代码主要做了以下事情：</p>
<ol>
<li>创建一个WSH Shell对象；</li>
<li>定义需要关闭的端口数组；</li>
<li>启动一个新的进程来执行端口监听程序；</li>
<li>设置一个循环，定时检查网络端口，如果发现需要关闭的端口被占用，则强制关闭相应的进程；</li>
<li>等待一段时间后再次检查。</li>
<li>当需要退出时可以通过关闭进程监听程序。</li>
</ol>
<p>需要注意的是，关闭网络端口对计算机系统的性能和安全性都有影响，因此应该慎重考虑是否需要关闭特定的端口。</p>
<h2 id="user-25">user:</h2>
<p>Jscript强制删除文件夹或文件</p>
<h2 id="assistant-25">assistant:</h2>
<p>JScript可以使用FileSystemObject对象访问计算机文件系统中的文件和文件夹，并且可以使用该对象来操作或删除这些文件或文件夹。</p>
<p>以下是一个基于JScript的示例代码，演示如何使用FileSystemObject对象强制删除指定的文件或文件夹：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">//创建FileSystemObject对象</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> fso </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Scripting.FileSystemObject"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//定义需要删除的文件或文件夹</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> targetPath </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"C:</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Users</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Username</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">Desktop</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">TestFolder"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">//判断是否存在目标文件或文件夹</span></span>
<span class="line"><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fso.</span><span style="color: #D2A8FF">FileExists</span><span style="color: #C9D1D9">(targetPath)) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//如果是文件，直接删除</span></span>
<span class="line"><span style="color: #C9D1D9">    fso.</span><span style="color: #D2A8FF">DeleteFile</span><span style="color: #C9D1D9">(targetPath, </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">} </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fso.</span><span style="color: #D2A8FF">FolderExists</span><span style="color: #C9D1D9">(targetPath)) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//如果是文件夹，删除文件夹及其所有内容</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> folder </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fso.</span><span style="color: #D2A8FF">GetFolder</span><span style="color: #C9D1D9">(targetPath);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> subfolders </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> folder.SubFolders;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> files </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> folder.Files;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//删除文件夹中的所有子文件夹</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> subfolders.Count; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> subfolder </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> subfolders.</span><span style="color: #D2A8FF">Item</span><span style="color: #C9D1D9">(i);</span></span>
<span class="line"><span style="color: #C9D1D9">        subfolder.</span><span style="color: #D2A8FF">Delete</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//删除文件夹中的所有文件</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> files.Count; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> file </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> files.</span><span style="color: #D2A8FF">Item</span><span style="color: #C9D1D9">(i);</span></span>
<span class="line"><span style="color: #C9D1D9">        file.</span><span style="color: #D2A8FF">Delete</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//删除文件夹本身</span></span>
<span class="line"><span style="color: #C9D1D9">    folder.</span><span style="color: #D2A8FF">Delete</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">} </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">alert</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"目标文件或文件夹不存在！"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>这个代码主要做了以下事情：</p>
<ol>
<li>创建FileSystemObject对象；</li>
<li>定义需要删除的文件或文件夹；</li>
<li>判断目标文件或文件夹是否存在；</li>
<li>如果是文件，则直接删除；</li>
<li>如果是文件夹，则首先删除文件夹中的所有子文件夹及其所有内容，然后再删除文件夹本身；</li>
<li>如果目标文件或文件夹不存在，则弹出提示信息。</li>
</ol>
<p>需要注意的是，在实际使用过程中，强制删除文件或文件夹可能会导致数据的不可恢复性，因此在使用强制删除功能时，应谨慎操作。</p>
<h2 id="user-26">user:</h2>
<p>如何查找一个文件被哪个进程占用</p>
<h2 id="assistant-26">assistant:</h2>
<p>在Windows系统中，可以使用命令行工具 handle.exe 或 Process Explorer 工具来查找一个文件被哪个进程占用。</p>
<p>方法一：使用 handle.exe 命令行工具查找</p>
<p>handle.exe 是一个开源命令行工具，可以列出系统中所有打开的句柄、共享内存区块和进程，以及它们所属的进程。</p>
<p>使用 handle.exe 命令行工具查找某个文件被哪个进程占用，可以按照以下步骤操作：</p>
<ol>
<li>下载 handle.exe 工具并解压缩；</li>
<li>打开命令行界面；</li>
<li>进入 handle.exe 工具所在目录；</li>
<li>使用以下命令查找目标文件所在的进程：handle.exe -a 文件名；</li>
<li>等待结果返回，即可查看文件被哪个进程占用。</li>
</ol>
<p>例如，若要查找文件 test.txt 被哪个进程占用，可以使用以下命令：handle.exe -a test.txt。</p>
<p>方法二：使用 Process Explorer 工具查找</p>
<p>Process Explorer 是一款免费的系统进程监视工具，可以显示系统上运行的所有进程信息，并且可以查看每个进程所打开的句柄、DLL等资源。通过 Process Explorer 工具查找某个文件被哪个进程占用，可以按照以下步骤操作：</p>
<ol>
<li>下载并运行 Process Explorer 工具；</li>
<li>在工具栏输入框中输入目标文件名，或者使用菜单栏的 “Find” -> “Find Handle or DLL” 命令，打开查找窗口；</li>
<li>在查找窗口中输入文件名，点击 “Search” 按钮；</li>
<li>等待搜索结果返回，若搜索到目标文件，则在 “Process” 列中查看所属进程的名称和PID，即可知道文件被哪个进程占用。</li>
</ol>
<p>需要注意的是，由于 handle.exe 和 Process Explorer 工具可以列出系统中所有打开的句柄和进程，因此使用这些工具进行操作需谨慎。</p>
<h2 id="user-27">user:</h2>
<p>可以用内置命令和工具实现吗</p>
<h2 id="assistant-27">assistant:</h2>
<p>Windows系统中还有一些内置命令和工具，可以用来实现查找文件被哪个进程占用，包括：</p>
<ol>
<li>
<p>Tasklist命令：用于显示当前系统中所有进程的列表，可以根据进程名或PID进行过滤。要查找占用文件的进程，需要先查找文件所在的PID，再用PID匹配到对应的进程信息。使用方法为在命令行中输入 <code>tasklist /svc /FI "PID eq PID号"</code>，其中PID号是要查找的进程的PID。</p>
</li>
<li>
<p>NetStat命令：用于显示当前系统中所有网络连接信息，可以根据本地或远程IP、端口号等进行过滤。如果文件被占用的应用正在进行网络通信，则可以使用NetStat命令查找占用文件的进程。使用方法为在命令行中输入 <code>netstat -ano</code>，再在输出结果中查找本地端口号对应的PID即可。</p>
</li>
<li>
<p>Resource Monitor工具：是Windows自带的一个系统性能监视工具，可以显示CPU、内存、磁盘、网络等资源的使用情况。可以使用该工具查找占用文件的进程。使用方法为在任务管理器中选择Resource Monitor，然后在文件夹选项卡中输入要查找的文件名，即可查看占用该文件的进程相关信息。</p>
</li>
</ol>
<p>需要注意的是，以上命令和工具都需要运行在管理员权限下，才能正常检索到系统中已经打开的文件句柄和进程信息。不同的命令和工具适用于不同的情况，可以根据具体情况选择合适的方法进行操作。</p>
<h2 id="user-28">user:</h2>
<p>Jscript查看某个进程打开的文件</p>
<h2 id="assistant-28">assistant:</h2>
<p>在Windows系统中，可以使用Jscript脚本来查看某个进程打开的文件。具体方法如下：</p>
<ol>
<li>
<p>打开一个文本编辑器，如Notepad；</p>
</li>
<li>
<p>输入以下代码：</p>
</li>
</ol>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> wmi </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">GetObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"winmgmts:</span><span style="color: #79C0FF">\\\\</span><span style="color: #A5D6FF">.</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">root</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">cimv2"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> list </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> wmi.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"SELECT * FROM Win32_Process WHERE ProcessID='进程的PID'"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> e</span><span style="color: #FF7B72">=new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(list);</span></span>
<span class="line"><span style="color: #FF7B72">for</span><span style="color: #C9D1D9">(;</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">e.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">();e.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> p </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> e.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> fso </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ActiveXObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Scripting.FileSystemObject"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> files </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> p.</span><span style="color: #D2A8FF">ExecMethod_</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"GetOwner"</span><span style="color: #C9D1D9">).Domain </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> p.</span><span style="color: #D2A8FF">ExecMethod_</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"GetOwner"</span><span style="color: #C9D1D9">).User </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">' is using:</span><span style="color: #79C0FF">\n\n</span><span style="color: #A5D6FF">'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> names </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> p.</span><span style="color: #D2A8FF">execquery</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'select * from Win32_Process where ParentProcessID='</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> p.ProcessID);</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> t</span><span style="color: #FF7B72">=new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(names);</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9">(;</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">t.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">();t.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">     </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> c</span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9">t.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">     </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> f</span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9">c.</span><span style="color: #D2A8FF">ExecMethod_</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"GetExecutablePath"</span><span style="color: #C9D1D9">).</span><span style="color: #D2A8FF">replace</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">/</span><span style="color: #79C0FF">[</span><span style="color: #FF7B72">^</span><span style="color: #79C0FF">\x20-\x7E]</span><span style="color: #FF7B72">+</span><span style="color: #A5D6FF">/</span><span style="color: #FF7B72">g</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> c.Name;</span></span>
<span class="line"><span style="color: #C9D1D9">     </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9">(f</span><span style="color: #FF7B72">==</span><span style="color: #A5D6FF">'System Idle Process'</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        f</span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF">'Idle Process'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">     }</span></span>
<span class="line"><span style="color: #C9D1D9">     </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> p</span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9">f;</span></span>
<span class="line"><span style="color: #C9D1D9">     files </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"* "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> p </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\n</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">     </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> handles </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> c.</span><span style="color: #D2A8FF">ExecQuery</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Select * From Win32_ProcessHandle Where ProcessID = '</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> c.ProcessID);</span></span>
<span class="line"><span style="color: #C9D1D9">     </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> e2</span><span style="color: #FF7B72">=new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Enumerator</span><span style="color: #C9D1D9">(handles);</span></span>
<span class="line"><span style="color: #C9D1D9">     </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9">(;</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">e2.</span><span style="color: #D2A8FF">atEnd</span><span style="color: #C9D1D9">();e2.</span><span style="color: #D2A8FF">moveNext</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> handle</span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9">e2.</span><span style="color: #D2A8FF">item</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> obj</span><span style="color: #FF7B72">=</span><span style="color: #D2A8FF">GetObject</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"winmgmts:{impersonationLevel=impersonate}!</span><span style="color: #79C0FF">\\\\</span><span style="color: #A5D6FF">.</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">root</span><span style="color: #79C0FF">\\</span><span style="color: #A5D6FF">cimv2:Win32_FileSystemObject.Handle=</span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> handle.Handle </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\"</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> path2</span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9">obj.</span><span style="color: #D2A8FF">ExecMethod_</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"GetAbsolutePathName"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        files </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"    "</span></span>
<span class="line"><span style="color: #C9D1D9">        files </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> handle.Handle </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">" --- "</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> path2 </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\n</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">     }</span></span>
<span class="line"><span style="color: #C9D1D9">     files </span><span style="color: #FF7B72">+=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"</span><span style="color: #79C0FF">\n</span><span style="color: #A5D6FF">"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">  WScript.StdOut.</span><span style="color: #D2A8FF">Write</span><span style="color: #C9D1D9">(files);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<ol start="3">
<li>
<p>将代码中的“进程的PID”修改为要查找的进程PID。</p>
</li>
<li>
<p>将文件另存为 .js 文件。</p>
</li>
<li>
<p>在命令行中运行该脚本，如运行命令 <code>cscript 文件名.js</code>。</p>
</li>
</ol>
<p>脚本执行完成后，即可在命令行输出中查看该进程打开的文件列表。</p>
<h2 id="user-29">user:</h2>
<p>winrm使用详解</p>
<h2 id="assistant-29">assistant:</h2>
<p>Error: Failed to fetch</p>
<h2 id="user-30">user:</h2>
<p>winrm使用详解</p>
<h2 id="assistant-30">assistant:</h2>
<p>WinRM是Windows远程管理的基础组件，它提供了一种远程管理Windows系统的方式，可以通过网络远程管理Windows系统；而在使用WinRM之前需要进行相应的配置。</p>
<p>下面详细讲解WinRM的使用和配置。</p>
<h2 id="winrm使用">WinRM使用</h2>
<p>WinRM在Windows Server 2008和Windows Vista以及之后的系统版本默认开启，因此在这些系统中WinRM可以直接使用。</p>
<p>WinRM支持基于SOAP（简单对象访问协议）和HTTP（超文本传输协议）的通信，在使用WinRM之前需要确定WinRM监听的端口号（HTTP默认端口号是5985，HTTPS默认端口号是5986），并且需要创建WinRM监听程序。</p>
<h3 id="检查winrm是否启动">检查WinRM是否启动</h3>
<p>在命令行中输入以下命令：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">WinRM quickconfig</span></span></code></pre>
<p>如果WinRM没有启动，系统会提示“WinRM服务已经没有运行”，此时可以启动WinRM。</p>
<h3 id="启动winrm">启动WinRM</h3>
<p>可以通过以下两个方法启动WinRM：</p>
<ol>
<li>使用命令行</li>
</ol>
<p>在命令行中输入以下命令：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc start winrm</span></span></code></pre>
<ol start="2">
<li>使用服务</li>
</ol>
<p>在服务列表中找到“Windows Remote Management”服务，右键选择“开始”即可启动。</p>
<h3 id="测试winrm">测试WinRM</h3>
<p>可以使用PowerShell或命令行测试WinRM是否可用，输入以下命令：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #79C0FF">Test-WSMan</span></span></code></pre>
<p>或</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">winrm qc</span></span></code></pre>
<p>如果测试通过，会有以下输出：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">wsmid           : http:</span><span style="color: #FF7B72">//</span><span style="color: #C9D1D9">schemas.dmtf.org</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">wbem</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">wsman</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">identity</span><span style="color: #FF7B72">/</span><span style="color: #79C0FF">1</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">wsmanidentity.xsd</span></span>
<span class="line"><span style="color: #C9D1D9">ProtocolVersion : http:</span><span style="color: #FF7B72">//</span><span style="color: #C9D1D9">schemas.dmtf.org</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">wbem</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">wsman</span><span style="color: #FF7B72">/</span><span style="color: #79C0FF">1</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">wsman.xsd</span></span>
<span class="line"><span style="color: #C9D1D9">ProductVendor   : Microsoft Corporation</span></span>
<span class="line"><span style="color: #C9D1D9">ProductVersion  : OS: </span><span style="color: #79C0FF">0.0</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9"> SP: </span><span style="color: #79C0FF">0.0</span><span style="color: #C9D1D9"> Stack: </span><span style="color: #79C0FF">3.0</span></span></code></pre>
<p>如果测试不通过，需要检查WinRM列表程序是否正确配置。</p>
<h3 id="配置winrm">配置WinRM</h3>
<p>如果需要修改WinRM的配置，可以使用以下方法：</p>
<ol>
<li>使用命令行</li>
</ol>
<p>使用以下命令查看WinRM的配置：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">winrm get winrm</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">config</span></span></code></pre>
<p>使用以下命令修改WinRM的配置：</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">winrm set winrm</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">config</span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">xxx</span></span></code></pre>
<p>其中，xxx为修改的参数，如“MaxTimeoutms”，表示最大超时时间（以毫秒为单位）。</p>
<ol start="2">
<li>使用组策略</li>
</ol>
<p>WinRM可以通过组策略进行配置。在组策略编辑器中，找到“计算机配置->管理模板->Windows组件->Windows Remote Management（WinRM）”，可以进行WinRM的相应配置。</p>
<h2 id="user-31">user:</h2>
<p>sc命令使用详解</p>
<h2 id="assistant-31">assistant:</h2>
<p>sc是Windows操作系统中的一个命令行工具，可以用于管理本地或远程计算机上的Windows服务，具有启动、停止、重启、暂停和继续服务的功能。</p>
<p>以下是sc命令的常见用法和参数解释：</p>
<h3 id="查看服务状态">查看服务状态</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc query [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称，如果未指定名称，则会列出所有服务的状态。</li>
</ul>
<h3 id="启动服务">启动服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc start [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<h3 id="停止服务">停止服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc stop [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<h3 id="重启服务">重启服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc restart [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<h3 id="暂停服务">暂停服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc pause [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<h3 id="继续服务">继续服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc </span><span style="color: #FF7B72">continue</span><span style="color: #C9D1D9"> [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<h3 id="安装服务">安装服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc create [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">binPath=</span><span style="color: #C9D1D9"> ] [</span><span style="color: #FF7B72">DisplayName=</span><span style="color: #C9D1D9"> ] [</span><span style="color: #FF7B72">start=</span><span style="color: #C9D1D9"> ] [</span><span style="color: #FF7B72">type=</span><span style="color: #C9D1D9"> ]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
<li><code>binPath</code>：服务的可执行文件路径。</li>
<li><code>DisplayName</code>：服务的显示名称。</li>
<li><code>start</code>：服务启动类型。可选值为<code>auto</code>、<code>demand</code>、<code>delayed-auto</code>、<code>disabled</code>。</li>
<li><code>type</code>：服务类型。可选值为<code>own</code>（独立进程）或<code>share</code>（共享进程）。</li>
</ul>
<h3 id="删除服务">删除服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc delete [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<h3 id="配置服务">配置服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc config [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">options</span><span style="color: #C9D1D9">]</span></span></code></pre>
<p>常见的选项包括：</p>
<ul>
<li><code>start=</code>：服务启动类型。可选值为<code>auto</code>、<code>demand</code>、<code>delayed-auto</code>、<code>manual</code>、<code>disabled</code>。</li>
<li><code>type=</code>：服务类型。可选值为<code>own</code>（独立进程）或<code>share</code>（共享进程）。</li>
<li><code>binPath=</code>：服务的可执行文件路径。</li>
<li><code>depend=</code>：指定服务所依赖的服务。</li>
<li><code>obj=</code>：指定服务运行的帐户名和密码。</li>
<li><code>password=</code>：指定服务运行的帐户密码。</li>
</ul>
<h3 id="查看服务依赖关系">查看服务依赖关系</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc qc [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<h3 id="查看服务详细信息">查看服务详细信息</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">sc queryex [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<p>除了上述常见用法和参数，sc命令还有一些其他的用法和参数，可以通过<code>sc /?</code>查看帮助文档了解更多详情。</p>
<h2 id="user-32">user:</h2>
<p>net命令</p>
<h2 id="assistant-32">assistant:</h2>
<p>net命令是Windows操作系统中一个非常有用的命令行工具，可以用于管理本地或远程计算机的网络资源（如共享文件夹、打印机等）、用户和组，还可以查看网络协议的状态等。下面是net命令的常见用法和参数：</p>
<h3 id="查看本地或远程计算机的共享资源">查看本地或远程计算机的共享资源</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net view [</span><span style="color: #FF7B72">computer</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>computer name</code>：计算机名称，如果未指定名称，则查看本地计算机的共享资源。</li>
</ul>
<h3 id="查看本地或远程计算机的共享连接状态">查看本地或远程计算机的共享、连接状态</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net use [</span><span style="color: #FF7B72">device</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">|</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9">] [\\</span><span style="color: #FF7B72">computername</span><span style="color: #C9D1D9">\</span><span style="color: #FF7B72">sharename</span><span style="color: #C9D1D9">[\</span><span style="color: #FF7B72">volume</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">password</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">|</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9">]]</span></span></code></pre>
<ul>
<li><code>device name</code>：本地设备名称，如F:、G:等。</li>
<li><code>*</code>：表示注销所有当前连接。</li>
<li><code>computername</code>：远程计算机名称。</li>
<li><code>sharename</code>：共享名称。</li>
<li><code>volume</code>：共享卷标名称。</li>
<li><code>password</code>：连接密码。</li>
</ul>
<h3 id="添加或删除本地或远程计算机的共享资源">添加或删除本地或远程计算机的共享资源</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net share [</span><span style="color: #FF7B72">share</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name=drive</span><span style="color: #C9D1D9">:</span><span style="color: #FF7B72">path</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">/grant</span><span style="color: #C9D1D9">:</span><span style="color: #FF7B72">user,permission</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">/remark</span><span style="color: #C9D1D9">:</span><span style="color: #A5D6FF">"text"</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>share name</code>：共享资源名称。</li>
<li><code>drive:path</code>：本地路径。</li>
<li><code>/grant</code>：指定用户和权限。</li>
<li><code>/remark</code>：注释，用于描述共享资源。</li>
</ul>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net share sharename </span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9">delete</span></span></code></pre>
<ul>
<li><code>sharename</code>：共享资源名称。</li>
</ul>
<h3 id="查看或修改本地或远程计算机的时间和日期">查看或修改本地或远程计算机的时间和日期</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net time [\</span><span style="color: #FF7B72">computer</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">/set</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>\computer</code>：计算机名称，如果未指定，则查看本地时间和日期。</li>
<li><code>/set</code>：设置本地时间和日期。</li>
</ul>
<h3 id="查看本地或远程计算机的用户和组">查看本地或远程计算机的用户和组</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net users [</span><span style="color: #FF7B72">username</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">/domain</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">/add</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">|</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">/delete</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">/active</span><span style="color: #C9D1D9">: {yes </span><span style="color: #FF7B72">|</span><span style="color: #C9D1D9"> no}]</span></span></code></pre>
<ul>
<li><code>username</code>：用户名，如果未指定，则查看所有用户。</li>
<li><code>/domain</code>：在域中列出用户。</li>
<li><code>/add</code>：添加新用户。</li>
<li><code>/delete</code>：删除用户。</li>
<li><code>/active</code>：列出状态为活动/非活动的用户。</li>
</ul>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net localgroup [</span><span style="color: #FF7B72">groupname</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">/domain</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">/add</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">|</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">/delete</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>groupname</code>：组名称。</li>
<li><code>/domain</code>：在域中列出组。</li>
<li><code>/add</code>：添加新组。</li>
<li><code>/delete</code>：删除组。</li>
</ul>
<h3 id="查看或修改本地或远程计算机上的服务">查看或修改本地或远程计算机上的服务</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net start [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称，如果未指定，则列出所有服务。</li>
</ul>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net stop [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net pause [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net </span><span style="color: #FF7B72">continue</span><span style="color: #C9D1D9"> [</span><span style="color: #FF7B72">service</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">name</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>service name</code>：服务名称。</li>
</ul>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">net config [</span><span style="color: #FF7B72">server</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">|</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">workstation</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>server</code>：查看或修改服务器工作站服务的状态。</li>
<li><code>workstation</code>：查看或修改工作站服务的状态。</li>
</ul>
<p>以上是net命令的常见用法和参数，可以通过<code>net /?</code>查看帮助文档了解更多详情。</p>
<h2 id="user-33">user:</h2>
<p>netsh命令</p>
<h2 id="assistant-33">assistant:</h2>
<p>netsh命令是Windows操作系统中的一个命令行工具，可以用于配置和管理本地或远程计算机的网络设置和连接。下面是netsh命令的常见用法和参数：</p>
<h3 id="查看本地或远程计算机的网络接口信息">查看本地或远程计算机的网络接口信息</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">netsh interface show interface</span></span></code></pre>
<h3 id="查看本地或远程计算机的ip地址信息">查看本地或远程计算机的IP地址信息</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">netsh interface ip show config</span></span></code></pre>
<h3 id="修改本地或远程计算机的ip地址信息">修改本地或远程计算机的IP地址信息</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">netsh interface ip set address [</span><span style="color: #FF7B72">name=</span><span style="color: #C9D1D9">]InterfaceName [</span><span style="color: #FF7B72">source=</span><span style="color: #C9D1D9">]dhcp</span><span style="color: #FF7B72">|static</span><span style="color: #C9D1D9"> [</span><span style="color: #FF7B72">addr=</span><span style="color: #C9D1D9">]IPAddress [</span><span style="color: #FF7B72">mask=</span><span style="color: #C9D1D9">]SubnetMask [</span><span style="color: #FF7B72">gateway=</span><span style="color: #C9D1D9">]{GatewayAddress}</span></span></code></pre>
<ul>
<li><code>name</code>：接口名称。</li>
<li><code>source</code>：地址来源，可选值为dhcp或static。</li>
<li><code>addr</code>：静态IP地址。</li>
<li><code>mask</code>：子网掩码。</li>
<li><code>gateway</code>：默认网关地址。</li>
</ul>
<h3 id="修改本地或远程计算机的dns服务器信息">修改本地或远程计算机的DNS服务器信息</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">netsh interface ip set dns [</span><span style="color: #FF7B72">name=</span><span style="color: #C9D1D9">]InterfaceName [</span><span style="color: #FF7B72">source=</span><span style="color: #C9D1D9">]dhcp</span><span style="color: #FF7B72">|static</span><span style="color: #C9D1D9"> [</span><span style="color: #FF7B72">addr=</span><span style="color: #C9D1D9">]DNSServerAddress1 [</span><span style="color: #FF7B72">register=</span><span style="color: #C9D1D9">]yes</span><span style="color: #FF7B72">|</span><span style="color: #C9D1D9">no</span></span></code></pre>
<ul>
<li><code>name</code>：接口名称。</li>
<li><code>source</code>：DNS来源，可选值为dhcp或static。</li>
<li><code>addr</code>：DNS服务器地址。</li>
<li><code>register</code>：是否注册DNS。</li>
</ul>
<h3 id="查看本地或远程计算机的网络路由信息">查看本地或远程计算机的网络路由信息</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">netsh interface ip show route</span></span></code></pre>
<h3 id="添加或删除本地或远程计算机的网络路由">添加或删除本地或远程计算机的网络路由</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">netsh interface ip add route Prefix Mask {IP</span><span style="color: #FF7B72">|</span><span style="color: #C9D1D9">Interface}  [</span><span style="color: #FF7B72">Metric</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">MetricValue</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">InterfaceName</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>Prefix</code>：目标IP前缀。</li>
<li><code>Mask</code>：子网掩码。</li>
<li><code>IP</code>：下一跳地址。</li>
<li><code>Interface</code>：使用的网络接口名称。</li>
<li><code>MetricValue</code>：路由优先级。</li>
<li><code>InterfaceName</code>：网络接口名称。</li>
</ul>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">netsh interface ip delete route Prefix [</span><span style="color: #FF7B72">Mask</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">Mask</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">Gateway</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">Gateway</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">metric</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">Metric</span><span style="color: #C9D1D9">] [</span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">InterfaceName</span><span style="color: #C9D1D9">]</span></span></code></pre>
<ul>
<li><code>Prefix</code>：目标IP前缀。</li>
<li><code>Mask</code>：子网掩码。</li>
<li><code>Gateway</code>：下一跳地址。</li>
<li><code>Metric</code>：路由优先级。</li>
<li><code>InterfaceName</code>：网络接口名称。</li>
</ul>
<p>除了上述常见用法和参数，netsh命令还有一些其他的用法和参数，可以通过<code>netsh /?</code>查看帮助文档了解更多详情。</p>
<h2 id="user-34">user:</h2>
<p>windows管理常用命令和使用实例</p>
<h2 id="assistant-34">assistant:</h2>
<p>以下是Windows系统管理常用命令及其使用实例：</p>
<h3 id="常规命令">常规命令</h3>
<h4 id="1-ping">1. ping</h4>
<ul>
<li>实例：<code>ping baidu.com</code></li>
<li>作用：测试网络连接和延迟，检查网络是否正常。</li>
</ul>
<h4 id="2-ipconfig">2. ipconfig</h4>
<ul>
<li>实例：<code>ipconfig /all</code></li>
<li>作用：查看本机IP地址、网卡、子网掩码等网络信息。</li>
</ul>
<h4 id="3-nslookup">3. nslookup</h4>
<ul>
<li>实例：<code>nslookup baidu.com</code></li>
<li>作用：查找域名对应的IP地址。</li>
</ul>
<h3 id="用户和账户管理命令">用户和账户管理命令</h3>
<h4 id="1-net-user">1. net user</h4>
<ul>
<li>实例：<code>net user username newpassword</code></li>
<li>作用：修改指定用户的密码。</li>
</ul>
<h4 id="2-net-localgroup">2. net localgroup</h4>
<ul>
<li>实例：<code>net localgroup administrators username /add</code></li>
<li>作用：将指定用户添加至管理员用户组。</li>
</ul>
<h4 id="3-net-user">3. net user</h4>
<ul>
<li>实例：<code>net user username /delete</code></li>
<li>作用：删除指定用户。</li>
</ul>
<h3 id="服务管理命令">服务管理命令</h3>
<h4 id="1-net-start">1. net start</h4>
<ul>
<li>实例：<code>net start service_name</code></li>
<li>作用：启动指定服务。</li>
</ul>
<h4 id="2-net-stop">2. net stop</h4>
<ul>
<li>实例：<code>net stop service_name</code></li>
<li>作用：停止指定服务。</li>
</ul>
<h4 id="3-netstat">3. netstat</h4>
<ul>
<li>实例：<code>netstat -ano</code></li>
<li>作用：查看系统的TCP/IP连接情况。</li>
</ul>
<h3 id="系统信息命令">系统信息命令</h3>
<h4 id="1-systeminfo">1. systeminfo</h4>
<ul>
<li>实例：<code>systeminfo</code></li>
<li>作用：查看系统的详细信息，如操作系统版本、安装日期、系统启动时间等。</li>
</ul>
<h4 id="2-driverquery">2. driverquery</h4>
<ul>
<li>实例：<code>driverquery</code></li>
<li>作用：查看已安装的设备驱动程序信息。</li>
</ul>
<h4 id="3-tasklist">3. tasklist</h4>
<ul>
<li>实例：<code>tasklist</code></li>
<li>作用：查看当前正在运行的所有进程及其PID。</li>
</ul>
<h4 id="4-taskkill">4. taskkill</h4>
<ul>
<li>实例：<code>taskkill /pid 1234 /f</code></li>
<li>作用：结束指定PID的进程。</li>
</ul>
<p>以上是常用的Windows系统管理命令及其使用实例，这些命令可以在命令行中直接执行，也可以通过批处理脚本实现自动化操作。</p>
	</body></html>